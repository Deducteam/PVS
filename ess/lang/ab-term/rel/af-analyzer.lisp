;;; -*- Mode: Lisp; Package: ANALYSIS-FACILITY -*-

;;; Analyzer for grammar /usrea2/ergo/ess/lang/ab-term/rel/af-agr.txt
;;; Generated by ERGO Analysis box -- Version 1.0 (September 29, 1989)

(in-package "ANALYSIS-FACILITY")
(use-package '(:ergolisp))
(use-package '("AF-RUNTIME-LIB"))




(EXPORT '(AF-CONFAM AF-SYNFAM
                    AF-ATTRFAM
                    AGG-AF-ANALYZE
                    AGG-AF-ANALYZE-AT))
(RT-DEFCONFAM AF-CONFAM AGG)
(RT-DEFSYNFAM AF-SYNFAM AGG AF-CONFAM)
(RT-DEFATTRFAM AF-ATTRFAM AGG AF-SYNFAM)
(DEFUN AGG-AF-ANALYZE
       (%TERM% &KEY (NT 'AGG) CONTEXT)
       (RT-TRAP-CONSTRAINT-ERRORS
         (ECASE NT
                (AGG (RT-GET-ATTRFAM AF-ATTRFAM AGG %TERM%)))))
(DEFUN AGG-AF-ANALYZE-AT
       (%TERM% %OCC% &KEY (NT 'AGG) CONTEXT)
       (RT-TRAP-CONSTRAINT-ERRORS
         (ECASE NT
                (AGG (RT-GET-ATTRFAM-AT AF-ATTRFAM %TERM% %OCC%)))))

(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       AGG
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (AGG
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (2
                               (RT-MVB (GRAM)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           AGG
                                                           ID
                                                           0
                                                           %TERM%)
                                       (RT-VLS GRAM)))
                             (3 (RT-VLS))
                             (4
                               (RT-MVB (GRAM)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           AGG
                                                           ID
                                                           0
                                                           %TERM%)
                                       (LET ((LANG
                                               (RT-FUNCTION GET-LANG-STRUCT
                                                            GRAM)))
                                         (RT-MVB (T3 PAS)
                                                 (RT-GET-SYNFAM-ARGN-OPT
                                                   AF-SYNFAM
                                                   AGG
                                                   ID
                                                   1
                                                   %TERM%)
                                                 (LET ((P
                                                         (RT-OPT T3
                                                                 PAS
                                                                 (RT-SYMBOL NIL))))
                                                   (LET ((CONFAM
                                                           (RT-FUNCTION
                                                             GET-CONFAM-NAME
                                                             P)))
                                                     (LET ((SYNFAM
                                                             (RT-FUNCTION
                                                               GET-SYNFAM-NAME
                                                               P)))
                                                       (LET ((ATTRFAM
                                                               (RT-FUNCTION
                                                                 GET-ATTRFAM-NAME
                                                                 P)))
                                                         (RT-MVB (T4 EGRAM-OPT)
                                                                 (RT-GET-SYNFAM-ARGN-OPT
                                                                   AF-SYNFAM
                                                                   AGG
                                                                   EXT-GRAMMARS
                                                                   2
                                                                   %TERM%)
                                                                 (LET ((EGRAM
                                                                      (RT-OPT
                                                                      T4
                                                                      EGRAM-OPT
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                                   (RT-MVB
                                                                     (T5 ISIG)
                                                                     (RT-GET-SYNFAM-ARGN-OPT
                                                                      AF-SYNFAM
                                                                      AGG
                                                                      INTRINSIC-TERMS
                                                                      3
                                                                      %TERM%)
                                                                     (LET ((SIG
                                                                      (RT-OPT
                                                                      T5
                                                                      ISIG
                                                                      (RT-FUNCTION
                                                                      MK-SIG-NULL))))
                                                                      (RT-VLS
                                                                      LANG
                                                                      CONFAM
                                                                      SYNFAM
                                                                      ATTRFAM
                                                                      EGRAM
                                                                      SIG)))))))))))))
                             (OTHERWISE (RT-DELTA-ERROR 'AGG))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       EXT-GRAMMARS
                       (%N% %TERM%)
                       (GRAM-NAME)
                       (ERGO-IGNORE-IF-UNUSED GRAM-NAME)
                       (OPCASE
                         %TERM%
                         (EXT-GRAMLIST
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS GRAM-NAME))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       EXT-GRAM
                       (%N% %TERM%)
                       (GRAM-NAME)
                       (ERGO-IGNORE-IF-UNUSED GRAM-NAME)
                       (OPCASE
                         %TERM%
                         (EXT-GRAM
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (2 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'EXT-GRAM))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       INTRINSIC-TERMS
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (ITERMS
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       RULES
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             ATTRFAM
                             EXTGRAM
                             OSIG)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              ATTRFAM
                                              EXTGRAM
                                              OSIG)
                       (OPCASE
                         %TERM%
                         (RULELIST
                           (LET ((ERRCON (RT-FUNCTION MAKE-ERRCON)))
                             (COND ((> %N%
                                       (RT-LAST-CHILD %TERM%))
                                    (ERROR "Not that many children"))
                                   ((= (RT-NCHILD %TERM%)
                                       0)
                                    (RT-VLS _
                                            LANG
                                            CONFAM
                                            SYNFAM
                                            ATTRFAM
                                            EXTGRAM
                                            OSIG
                                            ERRCON))
                                   ((= (RT-NCHILD %TERM%) 1)
                                    (RT-VLS LANG
                                            CONFAM
                                            SYNFAM
                                            ATTRFAM
                                            EXTGRAM
                                            OSIG
                                            ERRCON))
                                   ((= %N%
                                       (RT-FIRST-CHILD %TERM%))
                                    (RT-VLS LANG
                                            CONFAM
                                            SYNFAM
                                            ATTRFAM
                                            EXTGRAM
                                            OSIG
                                            ERRCON))
                                   ((= %N%
                                       (RT-LAST-CHILD %TERM%))
                                    (RT-MVB (_ _ _ _ _ _ _ OSIG)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                RULES
                                                                RULE
                                                                (1- %N%)
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                ATTRFAM
                                                                EXTGRAM
                                                                OSIG)
                                            (RT-VLS LANG
                                                    CONFAM
                                                    SYNFAM
                                                    ATTRFAM
                                                    EXTGRAM
                                                    OSIG
                                                    ERRCON)))
                                   (T
                                    (RT-MVB (_ _ _ _ _ _ _ OSIG)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                RULES
                                                                RULE
                                                                (1- %N%)
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                ATTRFAM
                                                                EXTGRAM
                                                                OSIG)
                                            (RT-VLS LANG
                                                    CONFAM
                                                    SYNFAM
                                                    ATTRFAM
                                                    EXTGRAM
                                                    OSIG
                                                    ERRCON))))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       RULE
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             ATTRFAM
                             EXTGRAM
                             OSIG
                             ERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              ATTRFAM
                                              EXTGRAM
                                              OSIG
                                              ERRCON)
                       (OPCASE
                         %TERM%
                         (NT-RULE
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (2
                               (RT-MVB (TOKEN)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           RULE
                                                           ID
                                                           0
                                                           %TERM%
                                                           LANG
                                                           CONFAM
                                                           SYNFAM
                                                           ATTRFAM
                                                           EXTGRAM
                                                           OSIG
                                                           ERRCON)
                                       (RT-MVB (LHS-ATTR)
                                               (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                   RULE
                                                                   RULE-ATTRL
                                                                   1
                                                                   %TERM%
                                                                   LANG
                                                                   CONFAM
                                                                   SYNFAM
                                                                   ATTRFAM
                                                                   EXTGRAM
                                                                   OSIG
                                                                   ERRCON)
                                               (RT-MVB (T7 ATLIST)
                                                       (RT-GET-SYNFAM-ARGN-OPT
                                                         AF-SYNFAM
                                                         RULE
                                                         DECLARATION
                                                         3
                                                         %TERM%
                                                         LANG
                                                         CONFAM
                                                         SYNFAM
                                                         ATTRFAM
                                                         EXTGRAM
                                                         OSIG
                                                         ERRCON)
                                                       (LET ((DECL
                                                               (RT-OPT T7
                                                                      ATLIST
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                         (LET ((INH
                                                                 (RT-FUNCTION
                                                                   GET-INH-NAMES
                                                                   LHS-ATTR)))
                                                           (LET ((NERRCON
                                                                   (RT-FUNCTION
                                                                     SET-ERRCON-SORT
                                                                     TOKEN
                                                                     ERRCON)))
                                                             (LET ((OATTRDEFS
                                                                     (RT-FUNCTION
                                                                      ENTERINIT
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      INH
                                                                      NERRCON)))
                                                               (LET ((ISIG
                                                                      (RT-FUNCTION
                                                                      DEFINE-SORT
                                                                      TOKEN
                                                                      LHS-ATTR
                                                                      OSIG)))
                                                                 (RT-VLS LANG
                                                                      CONFAM
                                                                      SYNFAM
                                                                      EXTGRAM
                                                                      TOKEN
                                                                      LHS-ATTR
                                                                      DECL
                                                                      OATTRDEFS
                                                                      ISIG
                                                                      NERRCON))))))))))
                             (3 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'NT-RULE))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       ALTERNATIVE
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             EXTGRAM
                             SORT
                             LHS-ATTR
                             DECL
                             ATTRDEFS
                             OSIG
                             ERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              EXTGRAM
                                              SORT
                                              LHS-ATTR
                                              DECL
                                              ATTRDEFS
                                              OSIG
                                              ERRCON)
                       (OPCASE
                         %TERM%
                         (ALTERNATIVE
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1
                               (LET ((OTAGS (RT-SYMBOL NIL)))
                                 (LET ((OPOS 0))
                                   (RT-MVB (OPER)
                                           (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                               ALTERNATIVE
                                                               ID
                                                               0
                                                               %TERM%
                                                               LANG
                                                               CONFAM
                                                               SYNFAM
                                                               EXTGRAM
                                                               SORT
                                                               LHS-ATTR
                                                               DECL
                                                               ATTRDEFS
                                                               OSIG
                                                               ERRCON)
                                           (LET ((N-LHS
                                                   (RT-FUNCTION NCHILDFUN
                                                                OPER
                                                                LANG)))
                                             (RT-MVB (T11 ITER-OPT)
                                                     (RT-GET-SYNFAM-ARGN-OPT
                                                       AF-SYNFAM
                                                       ALTERNATIVE
                                                       ITERS
                                                       4
                                                       %TERM%
                                                       LANG
                                                       CONFAM
                                                       SYNFAM
                                                       EXTGRAM
                                                       SORT
                                                       LHS-ATTR
                                                       DECL
                                                       ATTRDEFS
                                                       OSIG
                                                       ERRCON)
                                                     (LET ((ITER-ATTRS
                                                             (RT-OPT T11
                                                                     ITER-OPT
                                                                     (RT-SYMBOL
                                                                      NIL))))
                                                       (LET ((NERRCON
                                                               (RT-FUNCTION
                                                                 SET-ERRCON-OPER
                                                                 OPER
                                                                 ERRCON)))
                                                         (RT-VLS LANG
                                                                 CONFAM
                                                                 SYNFAM
                                                                 EXTGRAM
                                                                 ATTRDEFS
                                                                 OTAGS
                                                                 OPOS
                                                                 OSIG
                                                                 OPER
                                                                 N-LHS
                                                                 ITER-ATTRS
                                                                 NERRCON)))))))))
                             (2
                               (RT-MVB (_ _
                                          IATTRDEFS
                                          NTAGS
                                          _
                                          _
                                          _
                                          _)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           ALTERNATIVE
                                                           ALT-CSORTL
                                                           1
                                                           %TERM%
                                                           LANG
                                                           CONFAM
                                                           SYNFAM
                                                           EXTGRAM
                                                           SORT
                                                           LHS-ATTR
                                                           DECL
                                                           ATTRDEFS
                                                           OSIG
                                                           ERRCON)
                                       (RT-MVB (OPER)
                                               (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                   ALTERNATIVE
                                                                   ID
                                                                   0
                                                                   %TERM%
                                                                   LANG
                                                                   CONFAM
                                                                   SYNFAM
                                                                   EXTGRAM
                                                                   SORT
                                                                   LHS-ATTR
                                                                   DECL
                                                                   ATTRDEFS
                                                                   OSIG
                                                                   ERRCON)
                                               (LET ((NERRCON
                                                       (RT-FUNCTION
                                                         SET-ERRCON-OPER
                                                         OPER
                                                         ERRCON)))
                                                 (RT-VLS IATTRDEFS
                                                         NTAGS
                                                         NERRCON)))))
                             (3
                               (RT-MVB (_ _ IATTRDEFS NTAGS _ _ _ _)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           ALTERNATIVE
                                                           ALT-CSORTL
                                                           1
                                                           %TERM%
                                                           LANG
                                                           CONFAM
                                                           SYNFAM
                                                           EXTGRAM
                                                           SORT
                                                           LHS-ATTR
                                                           DECL
                                                           ATTRDEFS
                                                           OSIG
                                                           ERRCON)
                                       (RT-MVB (T11 ITER-OPT)
                                               (RT-GET-SYNFAM-ARGN-OPT
                                                 AF-SYNFAM
                                                 ALTERNATIVE
                                                 ITERS
                                                 4
                                                 %TERM%
                                                 LANG
                                                 CONFAM
                                                 SYNFAM
                                                 EXTGRAM
                                                 SORT
                                                 LHS-ATTR
                                                 DECL
                                                 ATTRDEFS
                                                 OSIG
                                                 ERRCON)
                                               (LET ((ITER-ATTRS
                                                       (RT-OPT T11
                                                               ITER-OPT
                                                               (RT-SYMBOL NIL))))
                                                 (RT-MVB (OPER)
                                                         (RT-GET-SYNFAM-ARGN
                                                           AF-SYNFAM
                                                           ALTERNATIVE
                                                           ID
                                                           0
                                                           %TERM%
                                                           LANG
                                                           CONFAM
                                                           SYNFAM
                                                           EXTGRAM
                                                           SORT
                                                           LHS-ATTR
                                                           DECL
                                                           ATTRDEFS
                                                           OSIG
                                                           ERRCON)
                                                         (LET ((NERRCON
                                                                 (RT-FUNCTION
                                                                   SET-ERRCON-OPER
                                                                   OPER
                                                                   ERRCON)))
                                                           (RT-VLS IATTRDEFS
                                                                   NTAGS
                                                                   ITER-ATTRS
                                                                   NERRCON)))))))
                             (4
                               (RT-MVB (OPER)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           ALTERNATIVE
                                                           ID
                                                           0
                                                           %TERM%
                                                           LANG
                                                           CONFAM
                                                           SYNFAM
                                                           EXTGRAM
                                                           SORT
                                                           LHS-ATTR
                                                           DECL
                                                           ATTRDEFS
                                                           OSIG
                                                           ERRCON)
                                       (LET ((NERRCON
                                               (RT-FUNCTION SET-ERRCON-OPER
                                                            OPER
                                                            ERRCON)))
                                         (RT-VLS ATTRDEFS NERRCON))))
                             (OTHERWISE (RT-DELTA-ERROR 'ALTERNATIVE))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       LHS-ATTR
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (INH-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INH-ATTR))))
                         (SYN-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'SYN-ATTR))))
                         (SYN-ATTRL
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'SYN-ATTRL))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       CHILD-SORT
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             EXTGRAM
                             OATTRDEFS
                             OTAGS
                             OPOS
                             OSIG
                             OPER
                             NCHILD
                             ITER-ATTRS
                             ERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              EXTGRAM
                                              OATTRDEFS
                                              OTAGS
                                              OPOS
                                              OSIG
                                              OPER
                                              NCHILD
                                              ITER-ATTRS
                                              ERRCON)
                       (OPCASE
                         %TERM%
                         (REG-CONSTITUENT
                           (ARGCASE
                             %N%
                             (0
                               (LET ((OPT (RT-SYMBOL NIL)))
                                 (RT-VLS LANG
                                         CONFAM
                                         SYNFAM
                                         EXTGRAM
                                         OATTRDEFS
                                         OTAGS
                                         OPOS
                                         OPT
                                         OSIG
                                         OPER
                                         NCHILD
                                         ITER-ATTRS
                                         ERRCON)))
                             (OTHERWISE (RT-DELTA-ERROR 'REG-CONSTITUENT))))
                         (OPT-CONSTITUENT
                           (ARGCASE
                             %N%
                             (0
                               (RT-MVB (T13 TOKEN)
                                       (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                               CHILD-SORT
                                                               TAG
                                                               1
                                                               %TERM%
                                                               LANG
                                                               CONFAM
                                                               SYNFAM
                                                               EXTGRAM
                                                               OATTRDEFS
                                                               OTAGS
                                                               OPOS
                                                               OSIG
                                                               OPER
                                                               NCHILD
                                                               ITER-ATTRS
                                                               ERRCON)
                                       (LET ((OPTNAME (RT-OPT T13
                                                              TOKEN
                                                              DTAG)))
                                         (LET ((OPT
                                                 (RT-FUNCTION GENTAG
                                                              OPTNAME)))
                                           (LET ((ITAGS
                                                   (RT-FUNCTION ENTERTAG
                                                                OTAGS
                                                                OPTNAME
                                                                OPT)))
                                             (RT-VLS LANG
                                                     CONFAM
                                                     SYNFAM
                                                     EXTGRAM
                                                     OATTRDEFS
                                                     ITAGS
                                                     OPOS
                                                     OPT
                                                     OSIG
                                                     OPER
                                                     NCHILD
                                                     ITER-ATTRS
                                                     ERRCON))))))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'OPT-CONSTITUENT))))
                         (NULL-CONSTITUENT
                           (ARGCASE
                             %N%
                             (OTHERWISE (RT-DELTA-ERROR 'NULL-CONSTITUENT))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       CHILD-SORT-INSTANCE
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             EXTGRAM
                             OATTRDEFS
                             OTAGS
                             POS
                             OPT
                             OSIG
                             OPER
                             NCHILD
                             ITER-ATTRS
                             ERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              EXTGRAM
                                              OATTRDEFS
                                              OTAGS
                                              POS
                                              OPT
                                              OSIG
                                              OPER
                                              NCHILD
                                              ITER-ATTRS
                                              ERRCON)
                       (OPCASE
                         %TERM%
                         (CONSTITUENT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'CONSTITUENT))))
                         (TLIST-CONSTITUENT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'TLIST-CONSTITUENT))))
                         (EMBEDDED-OP
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1
                               (LET ((OEATTRDEFS (RT-SYMBOL NIL)))
                                 (LET ((OPOS 0))
                                   (RT-MVB (TOKEN)
                                           (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                               CHILD-SORT-INSTANCE
                                                               ID
                                                               0
                                                               %TERM%
                                                               LANG
                                                               CONFAM
                                                               SYNFAM
                                                               EXTGRAM
                                                               OATTRDEFS
                                                               OTAGS
                                                               POS
                                                               OPT
                                                               OSIG
                                                               OPER
                                                               NCHILD
                                                               ITER-ATTRS
                                                               ERRCON)
                                           (LET ((N-LHS
                                                   (RT-FUNCTION NCHILDFUN
                                                                TOKEN
                                                                LANG)))
                                             (RT-VLS LANG
                                                     CONFAM
                                                     SYNFAM
                                                     EXTGRAM
                                                     OEATTRDEFS
                                                     OTAGS
                                                     OPOS
                                                     OSIG
                                                     TOKEN
                                                     N-LHS
                                                     ITER-ATTRS
                                                     ERRCON))))))
                             (2
                               (RT-MVB (_ _
                                          IEATTRDEFS
                                          NTAGS
                                          _
                                          _
                                          _
                                          _)
                                       (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                           CHILD-SORT-INSTANCE
                                                           EMB-CSORTL
                                                           1
                                                           %TERM%
                                                           LANG
                                                           CONFAM
                                                           SYNFAM
                                                           EXTGRAM
                                                           OATTRDEFS
                                                           OTAGS
                                                           POS
                                                           OPT
                                                           OSIG
                                                           OPER
                                                           NCHILD
                                                           ITER-ATTRS
                                                           ERRCON)
                                       (LET ((EITER-ATTRS (RT-SYMBOL NIL)))
                                         (RT-VLS IEATTRDEFS
                                                 NTAGS
                                                 EITER-ATTRS
                                                 ERRCON))))
                             (OTHERWISE (RT-DELTA-ERROR 'EMBEDDED-OP))))
                         (EXT-CONSTITUENT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (2 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'EXT-CONSTITUENT))))
                         (EXT-TLIST-CONSTITUENT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (2 (RT-VLS))
                             (OTHERWISE
                               (RT-DELTA-ERROR 'EXT-TLIST-CONSTITUENT))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       RHS-ATTR
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (INHR-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INHR-ATTR))))
                         (INHR-ATTRL
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INHR-ATTRL))))
                         (INHF-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INHF-ATTR))))
                         (INHL-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INHL-ATTR))))
                         (INHF-ATTRL
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INHF-ATTRL))))
                         (INHL-ATTRL
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'INHL-ATTRL))))
                         (SYNR-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'SYNR-ATTR))))
                         (SYNF-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'SYNF-ATTR))))
                         (SYNL-ATTR
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'SYNL-ATTR))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       DEFS
                       (%N% %TERM%)
                       (OATTRDEFS TAGS ITER-ATTRS ERRCON)
                       (ERGO-IGNORE-IF-UNUSED OATTRDEFS TAGS ITER-ATTRS ERRCON)
                       (OPCASE
                         %TERM%
                         (DEFLIST
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 ((= (RT-NCHILD %TERM%)
                                     0)
                                  (RT-VLS _ OATTRDEFS TAGS ITER-ATTRS ERRCON))
                                 ((= (RT-NCHILD %TERM%) 1)
                                  (RT-VLS OATTRDEFS TAGS ITER-ATTRS ERRCON))
                                 ((= %N%
                                     (RT-FIRST-CHILD %TERM%))
                                  (RT-VLS OATTRDEFS TAGS ITER-ATTRS ERRCON))
                                 ((= %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (RT-MVB (OATTRDEFS)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              DEFS
                                                              DEF
                                                              (1- %N%)
                                                              %TERM%
                                                              OATTRDEFS
                                                              TAGS
                                                              ITER-ATTRS
                                                              ERRCON)
                                          (RT-VLS OATTRDEFS
                                                  TAGS
                                                  ITER-ATTRS
                                                  ERRCON)))
                                 (T
                                  (RT-MVB (OATTRDEFS)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              DEFS
                                                              DEF
                                                              (1- %N%)
                                                              %TERM%
                                                              OATTRDEFS
                                                              TAGS
                                                              ITER-ATTRS
                                                              ERRCON)
                                          (RT-VLS OATTRDEFS
                                                  TAGS
                                                  ITER-ATTRS
                                                  ERRCON)))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       DEF
                       (%N% %TERM%)
                       (OATTRDEFS TAGS ITER-ATTRS ERRCON)
                       (ERGO-IGNORE-IF-UNUSED OATTRDEFS TAGS ITER-ATTRS ERRCON)
                       (OPCASE
                         %TERM%
                         (DEF
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1
                               (LET ((OPTCON (RT-SYMBOL NIL)))
                                 (RT-VLS OATTRDEFS TAGS OPTCON ERRCON)))
                             (OTHERWISE (RT-DELTA-ERROR 'DEF))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       CONSTRAINTS
                       (%N% %TERM%)
                       (ATTRDEFS TAGS ERRCON)
                       (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS ERRCON)
                       (OPCASE
                         %TERM%
                         (CONSTRLIST
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS ATTRDEFS TAGS ERRCON))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       CONSTRAINT
                       (%N% %TERM%)
                       (ATTRDEFS TAGS ERRCON)
                       (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS ERRCON)
                       (OPCASE
                         %TERM%
                         (CONSTRAINT
                           (ARGCASE
                             %N%
                             (0
                               (LET ((OPTCON (RT-SYMBOL NIL)))
                                 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON)))
                             (1
                               (LET ((OPTCON (RT-SYMBOL NIL)))
                                 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON)))
                             (OTHERWISE (RT-DELTA-ERROR 'CONSTRAINT))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       EXP
                       (%N% %TERM%)
                       (ATTRDEFS TAGS OPTCON ERRCON)
                       (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS OPTCON ERRCON)
                       (OPCASE
                         %TERM%
                         (ATTRIBUTE
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'ATTRIBUTE))))
                         (ATTRLIST
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'ATTRLIST))))
                         (VARIABLE
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'VARIABLE))))
                         (SYMBOL
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'SYMBOL))))
                         (NUMBER
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'NUMBER))))
                         (STRING
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'STRING))))
                         (ITE
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (1 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (2 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'ITE))))
                         (OPTSORT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (1
                               (RT-MVB (T13 TOKEN)
                                       (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                               EXP
                                                               TAG
                                                               2
                                                               %TERM%
                                                               ATTRDEFS
                                                               TAGS
                                                               OPTCON
                                                               ERRCON)
                                       (LET ((TAGNAME (RT-OPT T13
                                                              TOKEN
                                                              DTAG)))
                                         (LET ((NOPTCON
                                                 (RT-FUNCTION CONS
                                                              TAGNAME
                                                              OPTCON)))
                                           (RT-VLS ATTRDEFS
                                                   TAGS
                                                   NOPTCON
                                                   ERRCON)))))
                             (2 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'OPTSORT))))
                         (FUNCT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'FUNCT))))
                         (ABSY
                           (ARGCASE
                             %N% (OTHERWISE (RT-DELTA-ERROR 'ABSY))))
                         (MULT
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (1 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'MULT))))
                         (DIV
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (1 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'DIV))))
                         (ADD
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (1 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'ADD))))
                         (MINUS
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (1 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'MINUS))))
                         (NEG
                           (ARGCASE
                             %N%
                             (0 (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))
                             (OTHERWISE (RT-DELTA-ERROR 'NEG))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       EXPLIST
                       (%N% %TERM%)
                       (ATTRDEFS TAGS OPTCON ERRCON)
                       (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS OPTCON ERRCON)
                       (OPCASE
                         %TERM%
                         (ELIST
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       ITERS
                       (%N% %TERM%)
                       (ATTRDEFS ERRCON)
                       (ERGO-IGNORE-IF-UNUSED ATTRDEFS ERRCON)
                       (OPCASE
                         %TERM%
                         (ITERLIST
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS ATTRDEFS ERRCON))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       ITER
                       (%N% %TERM%)
                       (ATTRDEFS ERRCON)
                       (ERGO-IGNORE-IF-UNUSED ATTRDEFS ERRCON)
                       (OPCASE
                         %TERM%
                         (DECL-ITERATE
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (1
                               (LET ((TAGS (RT-SYMBOL NIL)))
                                 (LET ((OPTCON (RT-SYMBOL NIL)))
                                   (RT-VLS ATTRDEFS TAGS OPTCON ERRCON))))
                             (2 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'DECL-ITERATE))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       DECLARATION
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (DECL-FINAL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       TAG
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (TID
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'TID))))
                         (TNUM
                           (ARGCASE
                             %N%
                             (0 (RT-VLS))
                             (OTHERWISE (RT-DELTA-ERROR 'TNUM))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       RULE-ATTRL
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (RULE-ATTRL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       RULE-ALTL
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             EXTGRAM
                             TOKEN
                             LHS-ATTR
                             DECL
                             OATTRDEFS
                             ISIG
                             NERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              EXTGRAM
                                              TOKEN
                                              LHS-ATTR
                                              DECL
                                              OATTRDEFS
                                              ISIG
                                              NERRCON)
                       (OPCASE
                         %TERM%
                         (RULE-ALTL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 ((= (RT-NCHILD %TERM%)
                                     0)
                                  (RT-VLS _
                                          LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          TOKEN
                                          LHS-ATTR
                                          DECL
                                          OATTRDEFS
                                          ISIG
                                          NERRCON))
                                 ((= (RT-NCHILD %TERM%) 1)
                                  (RT-VLS LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          TOKEN
                                          LHS-ATTR
                                          DECL
                                          OATTRDEFS
                                          ISIG
                                          NERRCON))
                                 ((= %N%
                                     (RT-FIRST-CHILD %TERM%))
                                  (RT-VLS LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          TOKEN
                                          LHS-ATTR
                                          DECL
                                          OATTRDEFS
                                          ISIG
                                          NERRCON))
                                 ((= %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (RT-MVB (_ _ _ _ _ _ ISIG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RULE-ALTL
                                                              ALTERNATIVE
                                                              (1- %N%)
                                                              %TERM%
                                                              LANG
                                                              CONFAM
                                                              SYNFAM
                                                              EXTGRAM
                                                              TOKEN
                                                              LHS-ATTR
                                                              DECL
                                                              OATTRDEFS
                                                              ISIG
                                                              NERRCON)
                                          (RT-VLS LANG
                                                  CONFAM
                                                  SYNFAM
                                                  EXTGRAM
                                                  TOKEN
                                                  LHS-ATTR
                                                  DECL
                                                  OATTRDEFS
                                                  ISIG
                                                  NERRCON)))
                                 (T
                                  (RT-MVB (_ _ _ _ _ _ ISIG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RULE-ALTL
                                                              ALTERNATIVE
                                                              (1- %N%)
                                                              %TERM%
                                                              LANG
                                                              CONFAM
                                                              SYNFAM
                                                              EXTGRAM
                                                              TOKEN
                                                              LHS-ATTR
                                                              DECL
                                                              OATTRDEFS
                                                              ISIG
                                                              NERRCON)
                                          (RT-VLS LANG
                                                  CONFAM
                                                  SYNFAM
                                                  EXTGRAM
                                                  TOKEN
                                                  LHS-ATTR
                                                  DECL
                                                  OATTRDEFS
                                                  ISIG
                                                  NERRCON)))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       ALT-CSORTL
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             EXTGRAM
                             ATTRDEFS
                             OTAGS
                             OPOS
                             OSIG
                             OPER
                             N-LHS
                             ITER-ATTRS
                             NERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              EXTGRAM
                                              ATTRDEFS
                                              OTAGS
                                              OPOS
                                              OSIG
                                              OPER
                                              N-LHS
                                              ITER-ATTRS
                                              NERRCON)
                       (OPCASE
                         %TERM%
                         (ALT-CSORTL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 ((= (RT-NCHILD %TERM%)
                                     0)
                                  (RT-VLS _
                                          LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          ATTRDEFS
                                          OTAGS
                                          OPOS
                                          OSIG
                                          OPER
                                          N-LHS
                                          ITER-ATTRS
                                          NERRCON))
                                 ((= (RT-NCHILD %TERM%) 1)
                                  (RT-VLS LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          ATTRDEFS
                                          OTAGS
                                          OPOS
                                          OSIG
                                          OPER
                                          N-LHS
                                          ITER-ATTRS
                                          NERRCON))
                                 ((= %N%
                                     (RT-FIRST-CHILD %TERM%))
                                  (RT-VLS LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          ATTRDEFS
                                          OTAGS
                                          OPOS
                                          OSIG
                                          OPER
                                          N-LHS
                                          ITER-ATTRS
                                          NERRCON))
                                 ((= %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (RT-MVB
                                    (_ _ ATTRDEFS OTAGS OPOS _ _ OSIG)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        ALT-CSORTL
                                                        CHILD-SORT
                                                        (1- %N%)
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        ATTRDEFS
                                                        OTAGS
                                                        OPOS
                                                        OSIG
                                                        OPER
                                                        N-LHS
                                                        ITER-ATTRS
                                                        NERRCON)
                                    (RT-VLS LANG
                                            CONFAM
                                            SYNFAM
                                            EXTGRAM
                                            ATTRDEFS
                                            OTAGS
                                            OPOS
                                            OSIG
                                            OPER
                                            N-LHS
                                            ITER-ATTRS
                                            NERRCON)))
                                 (T
                                  (RT-MVB
                                    (_ _ ATTRDEFS OTAGS OPOS _ _ OSIG)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        ALT-CSORTL
                                                        CHILD-SORT
                                                        (1- %N%)
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        ATTRDEFS
                                                        OTAGS
                                                        OPOS
                                                        OSIG
                                                        OPER
                                                        N-LHS
                                                        ITER-ATTRS
                                                        NERRCON)
                                    (RT-VLS LANG
                                            CONFAM
                                            SYNFAM
                                            EXTGRAM
                                            ATTRDEFS
                                            OTAGS
                                            OPOS
                                            OSIG
                                            OPER
                                            N-LHS
                                            ITER-ATTRS
                                            NERRCON)))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       CONST-ATTRL
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (CONST-ATTRL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       TLIST-ATTRL
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (TLIST-ATTRL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       EMB-CSORTL
                       (%N% %TERM%)
                       (LANG CONFAM
                             SYNFAM
                             EXTGRAM
                             OEATTRDEFS
                             OTAGS
                             OPOS
                             OSIG
                             TOKEN
                             N-LHS
                             ITER-ATTRS
                             ERRCON)
                       (ERGO-IGNORE-IF-UNUSED LANG
                                              CONFAM
                                              SYNFAM
                                              EXTGRAM
                                              OEATTRDEFS
                                              OTAGS
                                              OPOS
                                              OSIG
                                              TOKEN
                                              N-LHS
                                              ITER-ATTRS
                                              ERRCON)
                       (OPCASE
                         %TERM%
                         (EMB-CSORTL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 ((= (RT-NCHILD %TERM%)
                                     0)
                                  (RT-VLS _
                                          LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          OEATTRDEFS
                                          OTAGS
                                          OPOS
                                          OSIG
                                          TOKEN
                                          N-LHS
                                          ITER-ATTRS
                                          ERRCON))
                                 ((= (RT-NCHILD %TERM%) 1)
                                  (RT-VLS LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          OEATTRDEFS
                                          OTAGS
                                          OPOS
                                          OSIG
                                          TOKEN
                                          N-LHS
                                          ITER-ATTRS
                                          ERRCON))
                                 ((= %N%
                                     (RT-FIRST-CHILD %TERM%))
                                  (RT-VLS LANG
                                          CONFAM
                                          SYNFAM
                                          EXTGRAM
                                          OEATTRDEFS
                                          OTAGS
                                          OPOS
                                          OSIG
                                          TOKEN
                                          N-LHS
                                          ITER-ATTRS
                                          ERRCON))
                                 ((= %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (RT-MVB
                                    (_ _ OEATTRDEFS OTAGS OPOS _ _ OSIG)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        EMB-CSORTL
                                                        CHILD-SORT
                                                        (1- %N%)
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        OEATTRDEFS
                                                        OTAGS
                                                        OPOS
                                                        OSIG
                                                        TOKEN
                                                        N-LHS
                                                        ITER-ATTRS
                                                        ERRCON)
                                    (RT-VLS LANG
                                            CONFAM
                                            SYNFAM
                                            EXTGRAM
                                            OEATTRDEFS
                                            OTAGS
                                            OPOS
                                            OSIG
                                            TOKEN
                                            N-LHS
                                            ITER-ATTRS
                                            ERRCON)))
                                 (T
                                  (RT-MVB
                                    (_ _ OEATTRDEFS OTAGS OPOS _ _ OSIG)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        EMB-CSORTL
                                                        CHILD-SORT
                                                        (1- %N%)
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        OEATTRDEFS
                                                        OTAGS
                                                        OPOS
                                                        OSIG
                                                        TOKEN
                                                        N-LHS
                                                        ITER-ATTRS
                                                        ERRCON)
                                    (RT-VLS LANG
                                            CONFAM
                                            SYNFAM
                                            EXTGRAM
                                            OEATTRDEFS
                                            OTAGS
                                            OPOS
                                            OSIG
                                            TOKEN
                                            N-LHS
                                            ITER-ATTRS
                                            ERRCON)))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       ECONST-ATTRL
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (ECONST-ATTRL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))
(RT-DEFCONFAM-DELTAFUN AF-CONFAM
                       ETLIST-ATTRL
                       (%N% %TERM%)
                       NIL
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM%
                         (ETLIST-ATTRL
                           (COND ((> %N%
                                     (RT-LAST-CHILD %TERM%))
                                  (ERROR "Not that many children"))
                                 (T (RT-VLS))))))

(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      AGG
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (AGG
                          (RT-MVB (T3 PAS)
                                  (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                          AGG
                                                          ID
                                                          1
                                                          %TERM%)
                                  (LET ((P (RT-OPT T3
                                                   PAS
                                                   (RT-SYMBOL NIL))))
                                    (LET ((ATTRFAM
                                            (RT-FUNCTION GET-ATTRFAM-NAME
                                                         P)))
                                      (LET ((CONFAM
                                              (RT-FUNCTION GET-CONFAM-NAME
                                                           P)))
                                        (RT-MVB (RCON RSYN RATT RS FS)
                                                (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                    AGG
                                                                    RULES
                                                                    4
                                                                    %TERM%)
                                                (RT-MVB (GRAM)
                                                        (RT-GET-SYNFAM-ARGN
                                                          AF-SYNFAM
                                                          AGG
                                                          ID
                                                          0
                                                          %TERM%)
                                                        (LET ((SYNFAM
                                                                (RT-FUNCTION
                                                                  GET-SYNFAM-NAME
                                                                  P)))
                                                          (RT-MVB
                                                            (T4 EGRAM-OPT)
                                                            (RT-GET-SYNFAM-ARGN-OPT
                                                              AF-SYNFAM
                                                              AGG
                                                              EXT-GRAMMARS
                                                              2
                                                              %TERM%)
                                                            (LET ((EGRAM
                                                                    (RT-OPT T4
                                                                      EGRAM-OPT
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                              (LET ((RDEC
                                                                      (RT-FUNCTION
                                                                      MLDEC-FUN
                                                                      GRAM
                                                                      P
                                                                      RS
                                                                      FS
                                                                      CONFAM
                                                                      SYNFAM
                                                                      ATTRFAM
                                                                      EGRAM)))
                                                                (RT-VLS RDEC
                                                                      RCON
                                                                      RSYN
                                                                      RATT))))))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      EXT-GRAMMARS
                      (%TERM%)
                      (GRAM-NAME)
                      (ERGO-IGNORE-IF-UNUSED GRAM-NAME)
                      (OPCASE
                        %TERM%
                        (EXT-GRAMLIST
                          (RT-MVB (EGRAM)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      EXT-GRAMMARS
                                                      EXT-GRAM
                                                      %TERM%
                                                      GRAM-NAME)
                                  (RT-VLS EGRAM)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      EXT-GRAM
                      (%TERM%)
                      (GRAM-NAME)
                      (ERGO-IGNORE-IF-UNUSED GRAM-NAME)
                      (OPCASE
                        %TERM%
                        (EXT-GRAM
                          (RT-MVB (PAS)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXT-GRAM
                                                      ID
                                                      1
                                                      %TERM%
                                                      GRAM-NAME)
                                  (RT-MVB (T6 GRAM)
                                          (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                                  EXT-GRAM
                                                                  ID
                                                                  0
                                                                  %TERM%
                                                                  GRAM-NAME)
                                          (RT-MVB (T3 PACK)
                                                  (RT-GET-SYNFAM-ARGN-OPT
                                                    AF-SYNFAM
                                                    EXT-GRAM
                                                    ID
                                                    2
                                                    %TERM%
                                                    GRAM-NAME)
                                                  (LET ((EGRAM
                                                          (RT-FUNCTION
                                                            MK-EXT-GRAM
                                                            (RT-OPT T6
                                                                    GRAM
                                                                    GRAM-NAME)
                                                            PAS
                                                            (RT-OPT T3
                                                                    PACK
                                                                    (RT-SYMBOL
                                                                      NIL)))))
                                                    (RT-VLS EGRAM))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      INTRINSIC-TERMS
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (ITERMS
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      INTRINSIC-TERMS
                                                      ID
                                                      %TERM%)
                                  (LET ((SIG (RT-FUNCTION DEF-TERM-SIG
                                                          TOKEN)))
                                    (RT-VLS SIG))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      RULES
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            ATTRFAM
                            EXTGRAM
                            OSIG)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             ATTRFAM
                                             EXTGRAM
                                             OSIG)
                      (OPCASE
                        %TERM%
                        (RULELIST
                          (RT-MVB (_ _ _ _ _ _ _ NSIG)
                                  (IF (ZEROP (RT-NCHILD %TERM%))
                                      (RT-MVB
                                        (_ LANG
                                           CONFAM
                                           SYNFAM
                                           ATTRFAM
                                           EXTGRAM
                                           OSIG
                                           ERRCON)
                                        (RT-DELTA-CONFAM AF-CONFAM
                                                         RULES
                                                         -1
                                                         %TERM%
                                                         LANG
                                                         CONFAM
                                                         SYNFAM
                                                         ATTRFAM
                                                         EXTGRAM
                                                         OSIG)
                                        (RT-VLS _ _ _ _ _ _ _ OSIG))
                                      (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                          RULES
                                                          RULE
                                                          (RT-LAST-CHILD %TERM%)
                                                          %TERM%
                                                          LANG
                                                          CONFAM
                                                          SYNFAM
                                                          ATTRFAM
                                                          EXTGRAM
                                                          OSIG))
                                  (RT-MVB
                                    (RCON0 RSYN0
                                           RATT0
                                           RCONEMBED0
                                           RSYNEMBED0
                                           RS0
                                           FS0
                                           _)
                                    (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                        RULES
                                                        RULE
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        ATTRFAM
                                                        EXTGRAM
                                                        OSIG)
                                    (LET ((ERRCON (RT-FUNCTION MAKE-ERRCON)))
                                      (PROGN
                                        (RT-CONSTRAINT-CHECK
                                          (RT-FUNCTION
                                            CHECK-ALL-NONTERMINALS-DEFINED
                                            NSIG)
                                          (RT-FUNCTION EMESSAGE
                                                       ERRCON
                                                       "Sort referenced but not defined"))
                                        (LET ((RCONEMBED
                                                (RT-FUNCTION MERGELIST
                                                             RCONEMBED0)))
                                          (LET ((RCON
                                                  (RT-FUNCTION APPEND
                                                               (RT-FUNCTION
                                                                 REMOVE
                                                                 (RT-SYMBOL NIL)
                                                                 RCON0)
                                                               RCONEMBED)))
                                            (LET ((RSYNEMBED
                                                    (RT-FUNCTION MERGELIST
                                                                 RSYNEMBED0)))
                                              (LET ((RSYN
                                                      (RT-FUNCTION APPEND
                                                                   (RT-FUNCTION
                                                                     REMOVE
                                                                     (RT-SYMBOL
                                                                      NIL)
                                                                     RSYN0)
                                                                   RSYNEMBED)))
                                                (LET ((RATT
                                                        (RT-FUNCTION REMOVE
                                                                     (RT-SYMBOL
                                                                      NIL)
                                                                     RATT0)))
                                                  (LET ((RS
                                                          (RT-FUNCTION
                                                            ROOT-SORT
                                                            (RT-FUNCTION REMOVE
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      RS0))))
                                                    (LET ((FS
                                                            (RT-FUNCTION REMOVE
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      FS0)))
                                                      (RT-VLS RCON
                                                              RSYN
                                                              RATT
                                                              RS
                                                              FS)))))))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      RULE
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            ATTRFAM
                            EXTGRAM
                            OSIG
                            ERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             ATTRFAM
                                             EXTGRAM
                                             OSIG
                                             ERRCON)
                      (OPCASE
                        %TERM%
                        (NT-RULE
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RULE
                                                      ID
                                                      0
                                                      %TERM%
                                                      LANG
                                                      CONFAM
                                                      SYNFAM
                                                      ATTRFAM
                                                      EXTGRAM
                                                      OSIG
                                                      ERRCON)
                                  (PROGN
                                    (RT-CONSTRAINT-CHECK
                                      (RT-FUNCTION CHECK-SORT
                                                   TOKEN
                                                   OSIG)
                                      (RT-FUNCTION EMESSAGE
                                                   ERRCON
                                                   "Duplicate sort definition found for ~A"
                                                   TOKEN))
                                    (RT-MVB (LHS-ATTR)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                RULE
                                                                RULE-ATTRL
                                                                1
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                ATTRFAM
                                                                EXTGRAM
                                                                OSIG
                                                                ERRCON)
                                            (PROGN
                                              (RT-CONSTRAINT-CHECK
                                                (RT-FUNCTION CHECK-SIGNATURE
                                                             TOKEN
                                                             LHS-ATTR
                                                             OSIG)
                                                (RT-FUNCTION EMESSAGE
                                                             ERRCON
                                                             "Signature of ~A does not agree with prior usage ~A"
                                                             TOKEN
                                                             LHS-ATTR))
                                              (RT-MVB
                                                (ALTCON ALTSYN
                                                        ALTATT
                                                        RCONEMBED0
                                                        RSYNEMBED0
                                                        NATTRDEFS
                                                        NSIG)
                                                (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                    RULE
                                                                    RULE-ALTL
                                                                    2
                                                                    %TERM%
                                                                    LANG
                                                                    CONFAM
                                                                    SYNFAM
                                                                    ATTRFAM
                                                                    EXTGRAM
                                                                    OSIG
                                                                    ERRCON)
                                                (PROGN
                                                  (RT-CONSTRAINT-CHECK
                                                    (RT-FUNCTION CHECK-LIST
                                                                 LHS-ATTR
                                                                 NATTRDEFS)
                                                    (RT-FUNCTION EMESSAGE
                                                                 ERRCON
                                                                 "Incorrect use of `*'"))
                                                  (PROGN
                                                    (RT-CONSTRAINT-CHECK
                                                      (RT-FUNCTION
                                                        CHECK-OPT-LHS
                                                        LHS-ATTR
                                                        NATTRDEFS)
                                                      (RT-FUNCTION EMESSAGE
                                                                   ERRCON
                                                                   "Illegal optional reference"))
                                                    (LET ((INH
                                                            (RT-FUNCTION
                                                              GET-INH-NAMES
                                                              LHS-ATTR)))
                                                      (LET ((RCON
                                                              (RT-FUNCTION
                                                                RULECON-FUN
                                                                CONFAM
                                                                TOKEN
                                                                INH
                                                                ALTCON)))
                                                        (LET ((RSYN
                                                                (RT-FUNCTION
                                                                  RULESYN-FUN
                                                                  SYNFAM
                                                                  TOKEN
                                                                  INH
                                                                  ALTSYN)))
                                                          (LET ((SYN
                                                                  (RT-FUNCTION
                                                                    GET-SYN-NAMES
                                                                    LHS-ATTR)))
                                                            (LET ((RATT
                                                                    (RT-FUNCTION
                                                                      RULEATT-FUN
                                                                      ATTRFAM
                                                                      TOKEN
                                                                      INH
                                                                      SYN
                                                                      ALTATT)))
                                                              (LET ((RCONEMBED
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      RCONEMBED0)))
                                                                (LET ((RSYNEMBED
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      RSYNEMBED0)))
                                                                  (LET ((ROOT-SORT
                                                                      TOKEN))
                                                                    (RT-MVB
                                                                      (T7
                                                                      ATLIST)
                                                                      (RT-GET-SYNFAM-ARGN-OPT
                                                                      AF-SYNFAM
                                                                      RULE
                                                                      DECLARATION
                                                                      3
                                                                      %TERM%
                                                                      LANG
                                                                      CONFAM
                                                                      SYNFAM
                                                                      ATTRFAM
                                                                      EXTGRAM
                                                                      OSIG
                                                                      ERRCON)
                                                                      (LET ((DECL
                                                                      (RT-OPT
                                                                      T7
                                                                      ATLIST
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                                      (LET ((FINAL-SORT
                                                                      (RT-ITE
                                                                      DECL
                                                                      (RT-FUNCTION
                                                                      CONS
                                                                      TOKEN
                                                                      INH)
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                                      (RT-VLS
                                                                      RCON
                                                                      RSYN
                                                                      RATT
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      ROOT-SORT
                                                                      FINAL-SORT
                                                                      NSIG))))))))))))))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      ALTERNATIVE
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            EXTGRAM
                            SORT
                            LHS-ATTR
                            DECL
                            ATTRDEFS
                            OSIG
                            ERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             EXTGRAM
                                             SORT
                                             LHS-ATTR
                                             DECL
                                             ATTRDEFS
                                             OSIG
                                             ERRCON)
                      (OPCASE
                        %TERM%
                        (ALTERNATIVE
                          (LET ((INH (RT-FUNCTION GET-INH-NAMES
                                                  LHS-ATTR)))
                            (RT-MVB (T11 ITER-OPT)
                                    (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                            ALTERNATIVE
                                                            ITERS
                                                            4
                                                            %TERM%
                                                            LANG
                                                            CONFAM
                                                            SYNFAM
                                                            EXTGRAM
                                                            SORT
                                                            LHS-ATTR
                                                            DECL
                                                            ATTRDEFS
                                                            OSIG
                                                            ERRCON)
                                    (LET ((ITER-ATTRS
                                            (RT-OPT T11
                                                    ITER-OPT
                                                    (RT-SYMBOL NIL))))
                                      (RT-MVB (OPER)
                                              (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                  ALTERNATIVE
                                                                  ID
                                                                  0
                                                                  %TERM%
                                                                  LANG
                                                                  CONFAM
                                                                  SYNFAM
                                                                  EXTGRAM
                                                                  SORT
                                                                  LHS-ATTR
                                                                  DECL
                                                                  ATTRDEFS
                                                                  OSIG
                                                                  ERRCON)
                                              (LET ((NERRCON
                                                      (RT-FUNCTION
                                                        SET-ERRCON-OPER
                                                        OPER
                                                        ERRCON)))
                                                (PROGN
                                                  (RT-CONSTRAINT-CHECK
                                                    (RT-FUNCTION CHECK-ITER
                                                                 INH
                                                                 ITER-ATTRS)
                                                    (RT-FUNCTION EMESSAGE
                                                                 NERRCON
                                                                 "Illegal iterate declaration"))
                                                  (RT-MVB
                                                    (RCONEMBED0 RSYNEMBED0
                                                                IATTRDEFS
                                                                _
                                                                _
                                                                RHS-ATTR
                                                                TLIST
                                                                NSIG)
                                                    (RT-GET-SYNFAM-ARGN
                                                      AF-SYNFAM
                                                      ALTERNATIVE
                                                      ALT-CSORTL
                                                      1
                                                      %TERM%
                                                      LANG
                                                      CONFAM
                                                      SYNFAM
                                                      EXTGRAM
                                                      SORT
                                                      LHS-ATTR
                                                      DECL
                                                      ATTRDEFS
                                                      OSIG
                                                      ERRCON)
                                                    (PROGN
                                                      (RT-CONSTRAINT-CHECK
                                                        (RT-FUNCTION
                                                          CHECK-OPT-RHS
                                                          RHS-ATTR
                                                          IATTRDEFS)
                                                        (RT-FUNCTION EMESSAGE
                                                                     NERRCON
                                                                     "Illegal reference to optional attribute"))
                                                      (PROGN
                                                        (RT-CONSTRAINT-CHECK
                                                          (RT-FUNCTION
                                                            CHECK-LIST-RHS
                                                            RHS-ATTR
                                                            IATTRDEFS)
                                                          (RT-FUNCTION EMESSAGE
                                                                      NERRCON
                                                                      "Incorrect use of `*'"))
                                                        (LET ((LSORT
                                                                (RT-FUNCTION
                                                                  FIRST
                                                                  (RT-FUNCTION
                                                                    REMOVE
                                                                    (RT-SYMBOL
                                                                      NIL)
                                                                    TLIST))))
                                                          (RT-MVB
                                                            (T7 NATTRDEFS-OPT)
                                                            (RT-GET-SYNFAM-ARGN-OPT
                                                              AF-SYNFAM
                                                              ALTERNATIVE
                                                              DEFS
                                                              3
                                                              %TERM%
                                                              LANG
                                                              CONFAM
                                                              SYNFAM
                                                              EXTGRAM
                                                              SORT
                                                              LHS-ATTR
                                                              DECL
                                                              ATTRDEFS
                                                              OSIG
                                                              ERRCON)
                                                            (LET ((NATTRDEFS
                                                                    (RT-OPT T7
                                                                      NATTRDEFS-OPT
                                                                      IATTRDEFS)))
                                                              (LET ((ALTCON
                                                                      (RT-FUNCTION
                                                                      ALTCON-FUN
                                                                      SYNFAM
                                                                      SORT
                                                                      LHS-ATTR
                                                                      OPER
                                                                      NATTRDEFS
                                                                      RHS-ATTR
                                                                      LSORT
                                                                      NERRCON)))
                                                                (RT-MVB
                                                                  (T9
                                                                    CONSTR-OPT)
                                                                  (RT-GET-SYNFAM-ARGN-OPT
                                                                    AF-SYNFAM
                                                                    ALTERNATIVE
                                                                    CONSTRAINTS
                                                                    2
                                                                    %TERM%
                                                                    LANG
                                                                    CONFAM
                                                                    SYNFAM
                                                                    EXTGRAM
                                                                    SORT
                                                                    LHS-ATTR
                                                                    DECL
                                                                    ATTRDEFS
                                                                    OSIG
                                                                    ERRCON)
                                                                  (LET ((CONSTR
                                                                      (RT-OPT
                                                                      T9
                                                                      CONSTR-OPT
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                                    (LET ((ALTSYN
                                                                      (RT-FUNCTION
                                                                      ALTSYN-FUN
                                                                      SORT
                                                                      LHS-ATTR
                                                                      OPER
                                                                      NATTRDEFS
                                                                      CONSTR
                                                                      NERRCON)))
                                                                      (LET ((ALTATT
                                                                      (RT-FUNCTION
                                                                      ALTATT-FUN
                                                                      SORT
                                                                      LHS-ATTR
                                                                      OPER
                                                                      NATTRDEFS
                                                                      DECL
                                                                      NERRCON)))
                                                                      (LET ((RCONEMBED
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      RCONEMBED0)))
                                                                      (LET ((RSYNEMBED
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      RSYNEMBED0)))
                                                                      (RT-VLS
                                                                      ALTCON
                                                                      ALTSYN
                                                                      ALTATT
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      NATTRDEFS
                                                                      NSIG)))))))))))))))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      LHS-ATTR
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (INH-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      LHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (LET ((ATTR
                                          (RT-FUNCTION MK-ATTRIBUTE
                                                       TOKEN
                                                       (RT-SYMBOL NIL)
                                                       (RT-SYMBOL INH))))
                                    (RT-VLS ATTR))))
                        (SYN-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      LHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (LET ((ATTR
                                          (RT-FUNCTION MK-ATTRIBUTE
                                                       TOKEN
                                                       (RT-SYMBOL NIL)
                                                       (RT-SYMBOL SYN))))
                                    (RT-VLS ATTR))))
                        (SYN-ATTRL
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      LHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (LET ((ATTR
                                          (RT-FUNCTION MK-ATTRIBUTE
                                                       TOKEN
                                                       (RT-SYMBOL LIST)
                                                       (RT-SYMBOL SYN)
                                                       (RT-SYMBOL NIL)
                                                       (RT-SYMBOL T))))
                                    (RT-VLS ATTR))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      CHILD-SORT
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            EXTGRAM
                            OATTRDEFS
                            OTAGS
                            OPOS
                            OSIG
                            OPER
                            NCHILD
                            ITER-ATTRS
                            ERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             EXTGRAM
                                             OATTRDEFS
                                             OTAGS
                                             OPOS
                                             OSIG
                                             OPER
                                             NCHILD
                                             ITER-ATTRS
                                             ERRCON)
                      (OPCASE
                        %TERM%
                        (REG-CONSTITUENT
                          (RT-MVB
                            (RCONEMBED RSYNEMBED
                                       NATTRDEFS
                                       NTAGS
                                       RHS-ATTR
                                       TLIST
                                       NSIG)
                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                CHILD-SORT
                                                CHILD-SORT-INSTANCE
                                                0
                                                %TERM%
                                                LANG
                                                CONFAM
                                                SYNFAM
                                                EXTGRAM
                                                OATTRDEFS
                                                OTAGS
                                                OPOS
                                                OSIG
                                                OPER
                                                NCHILD
                                                ITER-ATTRS
                                                ERRCON)
                            (LET ((NPOS (+ OPOS 1)))
                              (RT-VLS RCONEMBED
                                      RSYNEMBED
                                      NATTRDEFS
                                      NTAGS
                                      NPOS
                                      RHS-ATTR
                                      TLIST
                                      NSIG))))
                        (OPT-CONSTITUENT
                          (RT-MVB (T13 TOKEN)
                                  (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                          CHILD-SORT
                                                          TAG
                                                          1
                                                          %TERM%
                                                          LANG
                                                          CONFAM
                                                          SYNFAM
                                                          EXTGRAM
                                                          OATTRDEFS
                                                          OTAGS
                                                          OPOS
                                                          OSIG
                                                          OPER
                                                          NCHILD
                                                          ITER-ATTRS
                                                          ERRCON)
                                  (LET ((OPTNAME (RT-OPT T13 TOKEN DTAG)))
                                    (LET ((OPT (RT-FUNCTION GENTAG
                                                            OPTNAME)))
                                      (LET ((ITAGS
                                              (RT-FUNCTION ENTERTAG
                                                           OTAGS
                                                           OPTNAME
                                                           OPT)))
                                        (PROGN
                                          (RT-CONSTRAINT-CHECK ITAGS
                                                               (RT-FUNCTION
                                                                 EMESSAGE
                                                                 ERRCON
                                                                 "Duplicate tag definition ~A"
                                                                 OPTNAME))
                                          (RT-MVB
                                            (RCONEMBED RSYNEMBED
                                                       NATTRDEFS
                                                       NTAGS
                                                       RHS-ATTR
                                                       TLIST
                                                       NSIG)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                CHILD-SORT
                                                                CHILD-SORT-INSTANCE
                                                                0
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                EXTGRAM
                                                                OATTRDEFS
                                                                OTAGS
                                                                OPOS
                                                                OSIG
                                                                OPER
                                                                NCHILD
                                                                ITER-ATTRS
                                                                ERRCON)
                                            (LET ((NPOS (+ OPOS 1)))
                                              (RT-VLS RCONEMBED
                                                      RSYNEMBED
                                                      NATTRDEFS
                                                      NTAGS
                                                      NPOS
                                                      RHS-ATTR
                                                      TLIST
                                                      NSIG)))))))))
                        (NULL-CONSTITUENT
                          (LET ((RCONEMBED (RT-SYMBOL NIL)))
                            (LET ((RSYNEMBED (RT-SYMBOL NIL)))
                              (LET ((NATTRDEFS OATTRDEFS))
                                (LET ((NTAGS OTAGS))
                                  (LET ((NPOS (+ OPOS 1)))
                                    (LET ((RHS-ATTR (RT-SYMBOL NIL)))
                                      (LET ((TLIST (RT-SYMBOL NIL)))
                                        (LET ((NSIG OSIG))
                                          (RT-VLS RCONEMBED
                                                  RSYNEMBED
                                                  NATTRDEFS
                                                  NTAGS
                                                  NPOS
                                                  RHS-ATTR
                                                  TLIST
                                                  NSIG))))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      CHILD-SORT-INSTANCE
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            EXTGRAM
                            OATTRDEFS
                            OTAGS
                            POS
                            OPT
                            OSIG
                            OPER
                            NCHILD
                            ITER-ATTRS
                            ERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             EXTGRAM
                                             OATTRDEFS
                                             OTAGS
                                             POS
                                             OPT
                                             OSIG
                                             OPER
                                             NCHILD
                                             ITER-ATTRS
                                             ERRCON)
                      (OPCASE
                        %TERM%
                        (CONSTITUENT
                          (RT-MVB (RHS-ATTR)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      CHILD-SORT-INSTANCE
                                                      CONST-ATTRL
                                                      1
                                                      %TERM%
                                                      LANG
                                                      CONFAM
                                                      SYNFAM
                                                      EXTGRAM
                                                      OATTRDEFS
                                                      OTAGS
                                                      POS
                                                      OPT
                                                      OSIG
                                                      OPER
                                                      NCHILD
                                                      ITER-ATTRS
                                                      ERRCON)
                                  (PROGN
                                    (RT-CONSTRAINT-CHECK
                                      (RT-FUNCTION NOT
                                                   (RT-FUNCTION BBP RHS-ATTR))
                                      (RT-FUNCTION EMESSAGE
                                                   ERRCON
                                                   "Bucket brigade must appear inside list ~A"
                                                   RHS-ATTR))
                                    (RT-MVB (TOKEN)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                CHILD-SORT-INSTANCE
                                                                ID
                                                                0
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                EXTGRAM
                                                                OATTRDEFS
                                                                OTAGS
                                                                POS
                                                                OPT
                                                                OSIG
                                                                OPER
                                                                NCHILD
                                                                ITER-ATTRS
                                                                ERRCON)
                                            (PROGN
                                              (RT-CONSTRAINT-CHECK
                                                (RT-FUNCTION CHECK-SIGNATURE
                                                             TOKEN
                                                             RHS-ATTR
                                                             OSIG)
                                                (RT-FUNCTION EMESSAGE
                                                             ERRCON
                                                             "Signature of ~A does not agree with prior usage ~A"
                                                             TOKEN
                                                             RHS-ATTR))
                                              (PROGN
                                                (RT-CONSTRAINT-CHECK
                                                  (RT-FUNCTION CHECK-ITER-RHS
                                                               RHS-ATTR
                                                               ITER-ATTRS)
                                                  (RT-FUNCTION EMESSAGE
                                                               ERRCON
                                                               ""))
                                                (LET ((RCONEMBED
                                                        (RT-SYMBOL NIL)))
                                                  (LET ((RSYNEMBED
                                                          (RT-SYMBOL NIL)))
                                                    (LET ((ITER
                                                            (RT-FUNCTION
                                                              FIND-ITER
                                                              RHS-ATTR
                                                              ITER-ATTRS)))
                                                      (LET ((FAMILY
                                                              (RT-FUNCTION
                                                                MK-FAMILY
                                                                CONFAM
                                                                SYNFAM)))
                                                        (LET ((V
                                                                (RT-ITE ITER
                                                                      (RT-FUNCTION
                                                                      MK-ITERATE
                                                                      FAMILY
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      POS
                                                                      OPT
                                                                      (RT-FUNCTION
                                                                      ITER-INIT
                                                                      ITER)
                                                                      (RT-FUNCTION
                                                                      ITER-TEST
                                                                      ITER))
                                                                      (RT-FUNCTION
                                                                      MAKE-VISIT
                                                                      FAMILY
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      POS
                                                                      OPT))))
                                                          (LET ((SYN
                                                                  (RT-FUNCTION
                                                                    GET-SYN-NAMES
                                                                    RHS-ATTR)))
                                                            (LET ((NATTRDEFS
                                                                    (RT-FUNCTION
                                                                      ENTERLIST
                                                                      OATTRDEFS
                                                                      SYN
                                                                      V
                                                                      ERRCON)))
                                                              (LET ((NTAGS
                                                                      OTAGS))
                                                                (LET ((TLIST
                                                                      (RT-SYMBOL
                                                                      NIL)))
                                                                  (LET ((NSIG
                                                                      (RT-FUNCTION
                                                                      DEFINE-SIGNATURE
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      OSIG)))
                                                                    (RT-VLS
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      NATTRDEFS
                                                                      NTAGS
                                                                      RHS-ATTR
                                                                      TLIST
                                                                      NSIG)))))))))))))))))
                        (TLIST-CONSTITUENT
                          (RT-MVB (ATTR)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      CHILD-SORT-INSTANCE
                                                      TLIST-ATTRL
                                                      1
                                                      %TERM%
                                                      LANG
                                                      CONFAM
                                                      SYNFAM
                                                      EXTGRAM
                                                      OATTRDEFS
                                                      OTAGS
                                                      POS
                                                      OPT
                                                      OSIG
                                                      OPER
                                                      NCHILD
                                                      ITER-ATTRS
                                                      ERRCON)
                                  (LET ((RHS-ATTR
                                          (RT-FUNCTION FIND-MATES
                                                       ATTR
                                                       ERRCON)))
                                    (RT-MVB (TOKEN)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                CHILD-SORT-INSTANCE
                                                                ID
                                                                0
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                EXTGRAM
                                                                OATTRDEFS
                                                                OTAGS
                                                                POS
                                                                OPT
                                                                OSIG
                                                                OPER
                                                                NCHILD
                                                                ITER-ATTRS
                                                                ERRCON)
                                            (PROGN
                                              (RT-CONSTRAINT-CHECK
                                                (RT-FUNCTION CHECK-SIGNATURE
                                                             TOKEN
                                                             RHS-ATTR
                                                             OSIG)
                                                (RT-FUNCTION EMESSAGE
                                                             ERRCON
                                                             "Signature of ~A does not agree with prior usage ~A"
                                                             TOKEN
                                                             RHS-ATTR))
                                              (PROGN
                                                (RT-CONSTRAINT-CHECK
                                                  (RT-FUNCTION EQ NCHILD 1)
                                                  (RT-FUNCTION EMESSAGE
                                                               ERRCON
                                                               "List (~A) with implicit sort must have explicit operator"
                                                               TOKEN))
                                                (LET ((SORT
                                                        (RT-FUNCTION MAPSORT
                                                                     OPER
                                                                     POS
                                                                     NCHILD
                                                                     TOKEN
                                                                     LANG)))
                                                  (LET ((RCONEMBED
                                                          (RT-ITE
                                                            (RT-FUNCTION EQ
                                                                      NCHILD
                                                                      1)
                                                            (RT-SYMBOL NIL)
                                                            (RT-FUNCTION LIST
                                                                      (RT-FUNCTION
                                                                      RULECONTLIST-FUN
                                                                      CONFAM
                                                                      SYNFAM
                                                                      SORT
                                                                      RHS-ATTR
                                                                      TOKEN)))))
                                                    (LET ((RSYNEMBED
                                                            (RT-ITE
                                                              (RT-FUNCTION EQ
                                                                      NCHILD
                                                                      1)
                                                              (RT-SYMBOL NIL)
                                                              (RT-FUNCTION LIST
                                                                      (RT-FUNCTION
                                                                      RULESYNTLIST-FUN
                                                                      CONFAM
                                                                      SYNFAM
                                                                      SORT
                                                                      RHS-ATTR
                                                                      TOKEN)))))
                                                      (LET ((FAMILY
                                                              (RT-FUNCTION
                                                                MK-FAMILY
                                                                CONFAM
                                                                SYNFAM)))
                                                        (LET ((V
                                                                (RT-FUNCTION
                                                                  MAKE-VISIT
                                                                  FAMILY
                                                                  SORT
                                                                  RHS-ATTR
                                                                  POS
                                                                  OPT
                                                                  (RT-ITE
                                                                    (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                    RHS-ATTR
                                                                    (RT-SYMBOL
                                                                      NIL)))))
                                                          (LET ((SYN
                                                                  (RT-FUNCTION
                                                                    GET-SYN-NAMES
                                                                    RHS-ATTR)))
                                                            (LET ((NATTRDEFS
                                                                    (RT-FUNCTION
                                                                      ENTERLIST
                                                                      OATTRDEFS
                                                                      SYN
                                                                      V
                                                                      ERRCON)))
                                                              (LET ((NTAGS
                                                                      OTAGS))
                                                                (LET ((TLIST
                                                                      (RT-ITE
                                                                      (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                      TOKEN
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                                  (LET ((NSIG
                                                                      (RT-FUNCTION
                                                                      DEFINE-SIGNATURE
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      OSIG)))
                                                                    (RT-VLS
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      NATTRDEFS
                                                                      NTAGS
                                                                      RHS-ATTR
                                                                      TLIST
                                                                      NSIG)))))))))))))))))
                        (EMBEDDED-OP
                          (RT-MVB
                            (ERCONEMBED ERSYNEMBED
                                        IEATTRDEFS
                                        NTAGS
                                        _
                                        ERHS-ATTR
                                        ETLIST
                                        ISIG)
                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                CHILD-SORT-INSTANCE
                                                EMB-CSORTL
                                                1
                                                %TERM%
                                                LANG
                                                CONFAM
                                                SYNFAM
                                                EXTGRAM
                                                OATTRDEFS
                                                OTAGS
                                                POS
                                                OPT
                                                OSIG
                                                OPER
                                                NCHILD
                                                ITER-ATTRS
                                                ERRCON)
                            (LET ((ATTR (RT-FUNCTION MERGELIST
                                                     ERHS-ATTR)))
                              (RT-MVB (T7 NEATTRDEFS-OPT)
                                      (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                              CHILD-SORT-INSTANCE
                                                              DEFS
                                                              2
                                                              %TERM%
                                                              LANG
                                                              CONFAM
                                                              SYNFAM
                                                              EXTGRAM
                                                              OATTRDEFS
                                                              OTAGS
                                                              POS
                                                              OPT
                                                              OSIG
                                                              OPER
                                                              NCHILD
                                                              ITER-ATTRS
                                                              ERRCON)
                                      (LET ((NEATTRDEFS
                                              (RT-OPT T7
                                                      NEATTRDEFS-OPT
                                                      IEATTRDEFS)))
                                        (LET ((RHS-ATTR
                                                (RT-FUNCTION EMBED-LHS
                                                             ATTR
                                                             NEATTRDEFS)))
                                          (LET ((SORT
                                                  (RT-FUNCTION EMBED-SORT
                                                               OPER
                                                               POS
                                                               LANG)))
                                            (PROGN
                                              (RT-CONSTRAINT-CHECK
                                                (RT-FUNCTION CHECK-SIGNATURE
                                                             SORT
                                                             RHS-ATTR
                                                             ISIG)
                                                (RT-FUNCTION EMESSAGE
                                                             ERRCON
                                                             "Signature of ~A does not agree with prior usage ~A"
                                                             SORT
                                                             RHS-ATTR))
                                              (LET ((CONTEXT
                                                      (RT-FUNCTION
                                                        GET-INH-NAMES
                                                        RHS-ATTR)))
                                                (LET ((ELSORT
                                                        (RT-FUNCTION FIRST
                                                                     (RT-FUNCTION
                                                                      REMOVE
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      ETLIST))))
                                                  (LET ((EATTRDEFS
                                                          (RT-FUNCTION
                                                            CHANGEINIT
                                                            NEATTRDEFS
                                                            CONTEXT)))
                                                    (RT-MVB (TOKEN)
                                                            (RT-GET-SYNFAM-ARGN
                                                              AF-SYNFAM
                                                              CHILD-SORT-INSTANCE
                                                              ID
                                                              0
                                                              %TERM%
                                                              LANG
                                                              CONFAM
                                                              SYNFAM
                                                              EXTGRAM
                                                              OATTRDEFS
                                                              OTAGS
                                                              POS
                                                              OPT
                                                              OSIG
                                                              OPER
                                                              NCHILD
                                                              ITER-ATTRS
                                                              ERRCON)
                                                            (LET ((ALTCON
                                                                    (RT-FUNCTION
                                                                      LIST
                                                                      (RT-FUNCTION
                                                                      ALTCON-FUN
                                                                      SYNFAM
                                                                      SORT
                                                                      RHS-ATTR
                                                                      TOKEN
                                                                      EATTRDEFS
                                                                      ERHS-ATTR
                                                                      ELSORT
                                                                      ERRCON))))
                                                              (LET ((NEWSORTDEF
                                                                      (RT-FUNCTION
                                                                      CHECK-SORT
                                                                      SORT
                                                                      OSIG)))
                                                                (LET ((RCONEMBED
                                                                      (RT-ITE
                                                                      NEWSORTDEF
                                                                      (RT-FUNCTION
                                                                      CONS
                                                                      (RT-FUNCTION
                                                                      RULECON-FUN
                                                                      CONFAM
                                                                      SORT
                                                                      CONTEXT
                                                                      ALTCON)
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      ERCONEMBED))
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      ERCONEMBED))))
                                                                  (LET ((ALTSYN
                                                                      (RT-FUNCTION
                                                                      LIST
                                                                      (RT-FUNCTION
                                                                      ALTSYN-FUN
                                                                      SORT
                                                                      RHS-ATTR
                                                                      TOKEN
                                                                      EATTRDEFS
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      ERRCON))))
                                                                    (LET ((RSYNEMBED
                                                                      (RT-ITE
                                                                      NEWSORTDEF
                                                                      (RT-FUNCTION
                                                                      CONS
                                                                      (RT-FUNCTION
                                                                      RULESYN-FUN
                                                                      SYNFAM
                                                                      SORT
                                                                      CONTEXT
                                                                      ALTSYN)
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      ERSYNEMBED))
                                                                      (RT-FUNCTION
                                                                      MERGELIST
                                                                      ERSYNEMBED))))
                                                                      (LET ((FAMILY
                                                                      (RT-FUNCTION
                                                                      MK-FAMILY
                                                                      CONFAM
                                                                      SYNFAM)))
                                                                      (LET ((V
                                                                      (RT-FUNCTION
                                                                      MAKE-VISIT
                                                                      FAMILY
                                                                      SORT
                                                                      RHS-ATTR
                                                                      POS
                                                                      OPT)))
                                                                      (LET ((NATTRDEFS
                                                                      (RT-FUNCTION
                                                                      ENTERLIST
                                                                      OATTRDEFS
                                                                      (RT-FUNCTION
                                                                      GET-SYN-NAMES
                                                                      RHS-ATTR)
                                                                      V
                                                                      ERRCON)))
                                                                      (LET ((TLIST
                                                                      (RT-SYMBOL
                                                                      NIL)))
                                                                      (LET ((NSIG
                                                                      (RT-ITE
                                                                      NEWSORTDEF
                                                                      (RT-FUNCTION
                                                                      DEFINE-SORT
                                                                      SORT
                                                                      RHS-ATTR
                                                                      ISIG)
                                                                      ISIG)))
                                                                      (RT-VLS
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      NATTRDEFS
                                                                      NTAGS
                                                                      RHS-ATTR
                                                                      TLIST
                                                                      NSIG)))))))))))))))))))))))
                        (EXT-CONSTITUENT
                          (RT-MVB (RHS-ATTR)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      CHILD-SORT-INSTANCE
                                                      ECONST-ATTRL
                                                      2
                                                      %TERM%
                                                      LANG
                                                      CONFAM
                                                      SYNFAM
                                                      EXTGRAM
                                                      OATTRDEFS
                                                      OTAGS
                                                      POS
                                                      OPT
                                                      OSIG
                                                      OPER
                                                      NCHILD
                                                      ITER-ATTRS
                                                      ERRCON)
                                  (PROGN
                                    (RT-CONSTRAINT-CHECK
                                      (RT-FUNCTION NOT
                                                   (RT-FUNCTION BBP RHS-ATTR))
                                      (RT-FUNCTION EMESSAGE
                                                   ERRCON
                                                   "Bucket brigade must appear inside list ~A"
                                                   RHS-ATTR))
                                    (RT-MVB (TOKEN)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                CHILD-SORT-INSTANCE
                                                                ID
                                                                1
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                EXTGRAM
                                                                OATTRDEFS
                                                                OTAGS
                                                                POS
                                                                OPT
                                                                OSIG
                                                                OPER
                                                                NCHILD
                                                                ITER-ATTRS
                                                                ERRCON)
                                            (PROGN
                                              (RT-CONSTRAINT-CHECK
                                                (RT-FUNCTION CHECK-SIGNATURE
                                                             TOKEN
                                                             RHS-ATTR
                                                             OSIG)
                                                (RT-FUNCTION EMESSAGE
                                                             ERRCON
                                                             "Signature of ~A does not agree with prior usage ~A"
                                                             TOKEN
                                                             RHS-ATTR))
                                              (PROGN
                                                (RT-CONSTRAINT-CHECK
                                                  (RT-FUNCTION CHECK-ITER-RHS
                                                               RHS-ATTR
                                                               ITER-ATTRS)
                                                  (RT-FUNCTION EMESSAGE
                                                               ERRCON
                                                               ""))
                                                (RT-MVB (GRAM)
                                                        (RT-GET-SYNFAM-ARGN
                                                          AF-SYNFAM
                                                          CHILD-SORT-INSTANCE
                                                          ID
                                                          0
                                                          %TERM%
                                                          LANG
                                                          CONFAM
                                                          SYNFAM
                                                          EXTGRAM
                                                          OATTRDEFS
                                                          OTAGS
                                                          POS
                                                          OPT
                                                          OSIG
                                                          OPER
                                                          NCHILD
                                                          ITER-ATTRS
                                                          ERRCON)
                                                        (PROGN
                                                          (RT-CONSTRAINT-CHECK
                                                            (RT-FUNCTION
                                                              FIND-EXTGRAM
                                                              GRAM
                                                              EXTGRAM)
                                                            (RT-FUNCTION
                                                              EMESSAGE
                                                              ERRCON
                                                              "External grammar for (~A) undefined"
                                                              GRAM))
                                                          (LET ((RCONEMBED
                                                                  (RT-SYMBOL
                                                                    NIL)))
                                                            (LET ((RSYNEMBED
                                                                    (RT-SYMBOL
                                                                      NIL)))
                                                              (LET ((ITER
                                                                      (RT-FUNCTION
                                                                      FIND-ITER
                                                                      RHS-ATTR
                                                                      ITER-ATTRS)))
                                                                (LET ((PAS
                                                                      (RT-FUNCTION
                                                                      EXT-GRAM-PASS
                                                                      (RT-FUNCTION
                                                                      FIND-EXTGRAM
                                                                      GRAM
                                                                      EXTGRAM))))
                                                                  (LET ((FAMILY
                                                                      (RT-FUNCTION
                                                                      MK-FAMILY
                                                                      CONFAM
                                                                      (RT-FUNCTION
                                                                      GET-SYNFAM-NAME
                                                                      PAS))))
                                                                    (LET ((V
                                                                      (RT-ITE
                                                                      ITER
                                                                      (RT-FUNCTION
                                                                      MK-ITERATE
                                                                      FAMILY
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      POS
                                                                      OPT
                                                                      (RT-FUNCTION
                                                                      ITER-INIT
                                                                      ITER)
                                                                      (RT-FUNCTION
                                                                      ITER-TEST
                                                                      ITER))
                                                                      (RT-FUNCTION
                                                                      MAKE-VISIT
                                                                      FAMILY
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      POS
                                                                      OPT))))
                                                                      (LET ((SYN
                                                                      (RT-FUNCTION
                                                                      GET-SYN-NAMES
                                                                      RHS-ATTR)))
                                                                      (LET ((NATTRDEFS
                                                                      (RT-FUNCTION
                                                                      ENTERLIST
                                                                      OATTRDEFS
                                                                      SYN
                                                                      V
                                                                      ERRCON)))
                                                                      (LET ((NTAGS
                                                                      OTAGS))
                                                                      (LET ((TLIST
                                                                      (RT-SYMBOL
                                                                      NIL)))
                                                                      (LET ((NSIG
                                                                      (RT-FUNCTION
                                                                      DEFINE-EXT-SIGNATURE
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      OSIG)))
                                                                      (RT-VLS
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      NATTRDEFS
                                                                      NTAGS
                                                                      RHS-ATTR
                                                                      TLIST
                                                                      NSIG))))))))))))))))))))
                        (EXT-TLIST-CONSTITUENT
                          (RT-MVB (ATTR)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      CHILD-SORT-INSTANCE
                                                      ETLIST-ATTRL
                                                      2
                                                      %TERM%
                                                      LANG
                                                      CONFAM
                                                      SYNFAM
                                                      EXTGRAM
                                                      OATTRDEFS
                                                      OTAGS
                                                      POS
                                                      OPT
                                                      OSIG
                                                      OPER
                                                      NCHILD
                                                      ITER-ATTRS
                                                      ERRCON)
                                  (LET ((RHS-ATTR
                                          (RT-FUNCTION FIND-MATES ATTR ERRCON)))
                                    (RT-MVB (TOKEN)
                                            (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                CHILD-SORT-INSTANCE
                                                                ID
                                                                1
                                                                %TERM%
                                                                LANG
                                                                CONFAM
                                                                SYNFAM
                                                                EXTGRAM
                                                                OATTRDEFS
                                                                OTAGS
                                                                POS
                                                                OPT
                                                                OSIG
                                                                OPER
                                                                NCHILD
                                                                ITER-ATTRS
                                                                ERRCON)
                                            (PROGN
                                              (RT-CONSTRAINT-CHECK
                                                (RT-FUNCTION CHECK-SIGNATURE
                                                             TOKEN
                                                             RHS-ATTR
                                                             OSIG)
                                                (RT-FUNCTION EMESSAGE
                                                             ERRCON
                                                             "Signature of ~A does not agree with prior usage ~A"
                                                             TOKEN
                                                             RHS-ATTR))
                                              (RT-MVB (GRAM)
                                                      (RT-GET-SYNFAM-ARGN
                                                        AF-SYNFAM
                                                        CHILD-SORT-INSTANCE
                                                        ID
                                                        0
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        OATTRDEFS
                                                        OTAGS
                                                        POS
                                                        OPT
                                                        OSIG
                                                        OPER
                                                        NCHILD
                                                        ITER-ATTRS
                                                        ERRCON)
                                                      (PROGN
                                                        (RT-CONSTRAINT-CHECK
                                                          (RT-FUNCTION
                                                            FIND-EXTGRAM
                                                            GRAM
                                                            EXTGRAM)
                                                          (RT-FUNCTION EMESSAGE
                                                                      ERRCON
                                                                      "External grammar for (~A) undefined"
                                                                      GRAM))
                                                        (PROGN
                                                          (RT-CONSTRAINT-CHECK
                                                            (RT-FUNCTION EQ
                                                                      NCHILD
                                                                      1)
                                                            (RT-FUNCTION
                                                              EMESSAGE
                                                              ERRCON
                                                              "List (~A) with implicit sort must have explicit operator"
                                                              TOKEN))
                                                          (LET ((PAS
                                                                  (RT-FUNCTION
                                                                    EXT-GRAM-PASS
                                                                    (RT-FUNCTION
                                                                      FIND-EXTGRAM
                                                                      GRAM
                                                                      EXTGRAM))))
                                                            (LET ((SORT
                                                                    (RT-FUNCTION
                                                                      MAPSORT
                                                                      OPER
                                                                      POS
                                                                      NCHILD
                                                                      TOKEN
                                                                      LANG)))
                                                              (LET ((RCONEMBED
                                                                      (RT-ITE
                                                                      (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      (RT-FUNCTION
                                                                      LIST
                                                                      (RT-FUNCTION
                                                                      RULECONTLIST-FUN
                                                                      CONFAM
                                                                      (RT-FUNCTION
                                                                      GET-SYNFAM-NAME
                                                                      PAS)
                                                                      SORT
                                                                      RHS-ATTR
                                                                      TOKEN)))))
                                                                (LET ((RSYNEMBED
                                                                      (RT-ITE
                                                                      (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                      (RT-SYMBOL
                                                                      NIL)
                                                                      (RT-FUNCTION
                                                                      LIST
                                                                      (RT-FUNCTION
                                                                      RULESYNTLIST-FUN
                                                                      CONFAM
                                                                      (RT-FUNCTION
                                                                      GET-SYNFAM-NAME
                                                                      PAS)
                                                                      SORT
                                                                      RHS-ATTR
                                                                      TOKEN)))))
                                                                  (LET ((FAMILY
                                                                      (RT-ITE
                                                                      (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                      (RT-FUNCTION
                                                                      MK-FAMILY
                                                                      CONFAM
                                                                      (RT-FUNCTION
                                                                      GET-SYNFAM-NAME
                                                                      PAS))
                                                                      (RT-FUNCTION
                                                                      MK-FAMILY
                                                                      CONFAM
                                                                      SYNFAM))))
                                                                    (LET ((V
                                                                      (RT-FUNCTION
                                                                      MAKE-VISIT
                                                                      FAMILY
                                                                      SORT
                                                                      RHS-ATTR
                                                                      POS
                                                                      OPT
                                                                      (RT-ITE
                                                                      (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                      RHS-ATTR
                                                                      (RT-SYMBOL
                                                                      NIL)))))
                                                                      (LET ((SYN
                                                                      (RT-FUNCTION
                                                                      GET-SYN-NAMES
                                                                      RHS-ATTR)))
                                                                      (LET ((NATTRDEFS
                                                                      (RT-FUNCTION
                                                                      ENTERLIST
                                                                      OATTRDEFS
                                                                      SYN
                                                                      V
                                                                      ERRCON)))
                                                                      (LET ((NTAGS
                                                                      OTAGS))
                                                                      (LET ((TLIST
                                                                      (RT-ITE
                                                                      (RT-FUNCTION
                                                                      EQ
                                                                      NCHILD
                                                                      1)
                                                                      TOKEN
                                                                      (RT-SYMBOL
                                                                      NIL))))
                                                                      (LET ((NSIG
                                                                      (RT-FUNCTION
                                                                      DEFINE-EXT-SIGNATURE
                                                                      TOKEN
                                                                      RHS-ATTR
                                                                      OSIG)))
                                                                      (RT-VLS
                                                                      RCONEMBED
                                                                      RSYNEMBED
                                                                      NATTRDEFS
                                                                      NTAGS
                                                                      RHS-ATTR
                                                                      TLIST
                                                                      NSIG))))))))))))))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      RHS-ATTR
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (INHR-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (LET ((ATTR
                                          (RT-FUNCTION MK-ATTRIBUTE
                                                       TOKEN
                                                       (RT-SYMBOL DIST)
                                                       (RT-SYMBOL INH))))
                                    (RT-VLS ATTR))))
                        (INHR-ATTRL
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (LET ((ATTR
                                          (RT-FUNCTION MK-ATTRIBUTE
                                                       TOKEN
                                                       (RT-SYMBOL DIST)
                                                       (RT-SYMBOL INH)
                                                       (RT-SYMBOL NIL)
                                                       (RT-SYMBOL T))))
                                    (RT-VLS ATTR))))
                        (INHF-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (RT-MVB (TAG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RHS-ATTR
                                                              ID
                                                              1
                                                              %TERM%)
                                          (LET ((ATTR
                                                  (RT-FUNCTION MK-ATTRIBUTE
                                                               TOKEN
                                                               (RT-SYMBOL FIRST)
                                                               (RT-SYMBOL INH)
                                                               TAG)))
                                            (RT-VLS ATTR)))))
                        (INHL-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      1
                                                      %TERM%)
                                  (RT-MVB (TAG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RHS-ATTR
                                                              ID
                                                              0
                                                              %TERM%)
                                          (LET ((ATTR
                                                  (RT-FUNCTION MK-ATTRIBUTE
                                                               TOKEN
                                                               (RT-SYMBOL LAST)
                                                               (RT-SYMBOL INH)
                                                               TAG)))
                                            (RT-VLS ATTR)))))
                        (INHF-ATTRL
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (RT-MVB (TAG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RHS-ATTR
                                                              ID
                                                              1
                                                              %TERM%)
                                          (LET ((ATTR
                                                  (RT-FUNCTION MK-ATTRIBUTE
                                                               TOKEN
                                                               (RT-SYMBOL FIRST)
                                                               (RT-SYMBOL INH)
                                                               TAG
                                                               (RT-SYMBOL T))))
                                            (RT-VLS ATTR)))))
                        (INHL-ATTRL
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      1
                                                      %TERM%)
                                  (RT-MVB (TAG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RHS-ATTR
                                                              ID
                                                              0
                                                              %TERM%)
                                          (LET ((ATTR
                                                  (RT-FUNCTION MK-ATTRIBUTE
                                                               TOKEN
                                                               (RT-SYMBOL LAST)
                                                               (RT-SYMBOL INH)
                                                               TAG
                                                               (RT-SYMBOL T))))
                                            (RT-VLS ATTR)))))
                        (SYNR-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (LET ((ATTR
                                          (RT-FUNCTION MK-ATTRIBUTE
                                                       TOKEN
                                                       (RT-SYMBOL LIST)
                                                       (RT-SYMBOL SYN))))
                                    (RT-VLS ATTR))))
                        (SYNF-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      0
                                                      %TERM%)
                                  (RT-MVB (TAG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RHS-ATTR
                                                              ID
                                                              1
                                                              %TERM%)
                                          (LET ((ATTR
                                                  (RT-FUNCTION MK-ATTRIBUTE
                                                               TOKEN
                                                               (RT-SYMBOL FIRST)
                                                               (RT-SYMBOL SYN)
                                                               TAG)))
                                            (RT-VLS ATTR)))))
                        (SYNL-ATTR
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      RHS-ATTR
                                                      ID
                                                      1
                                                      %TERM%)
                                  (RT-MVB (TAG)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              RHS-ATTR
                                                              ID
                                                              0
                                                              %TERM%)
                                          (LET ((ATTR
                                                  (RT-FUNCTION MK-ATTRIBUTE
                                                               TOKEN
                                                               (RT-SYMBOL LAST)
                                                               (RT-SYMBOL SYN)
                                                               TAG)))
                                            (RT-VLS ATTR)))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      DEFS
                      (%TERM%)
                      (OATTRDEFS TAGS ITER-ATTRS ERRCON)
                      (ERGO-IGNORE-IF-UNUSED OATTRDEFS TAGS ITER-ATTRS ERRCON)
                      (OPCASE
                        %TERM%
                        (DEFLIST
                          (RT-MVB (NATTRDEFS)
                                  (IF (ZEROP (RT-NCHILD %TERM%))
                                      (RT-MVB
                                        (_ OATTRDEFS TAGS ITER-ATTRS ERRCON)
                                        (RT-DELTA-CONFAM AF-CONFAM
                                                         DEFS
                                                         -1
                                                         %TERM%
                                                         OATTRDEFS
                                                         TAGS
                                                         ITER-ATTRS
                                                         ERRCON)
                                        (RT-VLS OATTRDEFS))
                                      (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                          DEFS
                                                          DEF
                                                          (RT-LAST-CHILD %TERM%)
                                                          %TERM%
                                                          OATTRDEFS
                                                          TAGS
                                                          ITER-ATTRS
                                                          ERRCON))
                                  (RT-VLS NATTRDEFS)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      DEF
                      (%TERM%)
                      (OATTRDEFS TAGS ITER-ATTRS ERRCON)
                      (ERGO-IGNORE-IF-UNUSED OATTRDEFS TAGS ITER-ATTRS ERRCON)
                      (OPCASE
                        %TERM%
                        (DEF
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      DEF
                                                      ID
                                                      0
                                                      %TERM%
                                                      OATTRDEFS
                                                      TAGS
                                                      ITER-ATTRS
                                                      ERRCON)
                                  (PROGN
                                    (RT-CONSTRAINT-CHECK
                                      (RT-FUNCTION NOT
                                                   (RT-FUNCTION LOOKP
                                                                OATTRDEFS
                                                                TOKEN))
                                      (RT-FUNCTION EMESSAGE
                                                   ERRCON
                                                   "Duplicate definition of attribute ~A"
                                                   TOKEN))
                                    (LET ((ITER
                                            (RT-FUNCTION FIND-ITER-EVAL
                                                         TOKEN
                                                         ITER-ATTRS)))
                                      (RT-MVB (ATTRS-USED ECODE)
                                              (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                  DEF
                                                                  EXP
                                                                  1
                                                                  %TERM%
                                                                  OATTRDEFS
                                                                  TAGS
                                                                  ITER-ATTRS
                                                                  ERRCON)
                                              (LET ((EXP-CODE
                                                      (RT-ITE ITER
                                                              (RT-FUNCTION
                                                                MAKE-EXP-ITERATE
                                                                ECODE
                                                                ATTRS-USED
                                                                (RT-FUNCTION
                                                                  ITER-INIT
                                                                  ITER)
                                                                (RT-FUNCTION
                                                                  ITER-TEST
                                                                  ITER))
                                                              (RT-FUNCTION
                                                                MAKE-EXP
                                                                ECODE
                                                                ATTRS-USED))))
                                                (LET ((NATTRDEFS
                                                        (RT-FUNCTION
                                                          CHANGE-ATTRDEF
                                                          OATTRDEFS
                                                          TOKEN
                                                          EXP-CODE)))
                                                  (RT-VLS NATTRDEFS))))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      CONSTRAINTS
                      (%TERM%)
                      (ATTRDEFS TAGS ERRCON)
                      (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS ERRCON)
                      (OPCASE
                        %TERM%
                        (CONSTRLIST
                          (RT-MVB (CON)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      CONSTRAINTS
                                                      CONSTRAINT
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      ERRCON)
                                  (RT-VLS CON)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      CONSTRAINT
                      (%TERM%)
                      (ATTRDEFS TAGS ERRCON)
                      (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS ERRCON)
                      (OPCASE
                        %TERM%
                        (CONSTRAINT
                          (RT-MVB (AU-COND EC-COND)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      CONSTRAINT
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      ERRCON)
                                  (RT-MVB (AU-MESS EC-MESS)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              CONSTRAINT
                                                              EXP
                                                              1
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              ERRCON)
                                          (LET ((CON
                                                  (RT-FUNCTION CONS
                                                               (RT-FUNCTION
                                                                 MAKE-EXP
                                                                 EC-COND
                                                                 AU-COND)
                                                               (RT-FUNCTION
                                                                 MAKE-EXP
                                                                 EC-MESS
                                                                 AU-MESS))))
                                            (RT-VLS CON)))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      EXP
                      (%TERM%)
                      (ATTRDEFS TAGS OPTCON ERRCON)
                      (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS OPTCON ERRCON)
                      (OPCASE
                        %TERM%
                        (ATTRIBUTE
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      ID
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (PROGN
                                    (RT-CONSTRAINT-CHECK
                                      (RT-FUNCTION CHECKOPT
                                                   ATTRDEFS
                                                   TAGS
                                                   OPTCON
                                                   TOKEN)
                                      (RT-FUNCTION EMESSAGE
                                                   ERRCON
                                                   "Unguarded optional attribute ~A"
                                                   TOKEN))
                                    (LET ((ATTRS-USED
                                            (RT-FUNCTION LIST TOKEN)))
                                      (LET ((ECODE TOKEN))
                                        (RT-VLS ATTRS-USED ECODE))))))
                        (ATTRLIST
                          (RT-MVB (AU EC)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (PROGN
                                    (RT-CONSTRAINT-CHECK
                                      (RT-FUNCTION IS-ATTR AU EC)
                                      (RT-FUNCTION EMESSAGE
                                                   ERRCON
                                                   "Expression should be attribute ~A"
                                                   EC))
                                    (LET ((TOKEN
                                            (RT-FUNCTION EXTRACT-ATTR
                                                         AU
                                                         EC)))
                                      (PROGN
                                        (RT-CONSTRAINT-CHECK
                                          (RT-FUNCTION CHECKOPT
                                                       ATTRDEFS
                                                       TAGS
                                                       OPTCON
                                                       TOKEN)
                                          (RT-FUNCTION EMESSAGE
                                                       ERRCON
                                                       "Unguarded optional attribute ~A"
                                                       TOKEN))
                                        (PROGN
                                          (RT-CONSTRAINT-CHECK
                                            (RT-FUNCTION ATTRLISTP
                                                         ATTRDEFS
                                                         TOKEN)
                                            (RT-FUNCTION EMESSAGE
                                                         ERRCON
                                                         "Attribute not defined within list, ~A"
                                                         TOKEN))
                                          (LET ((ATTRS-USED
                                                  (RT-FUNCTION LIST TOKEN)))
                                            (LET ((ECODE TOKEN))
                                              (RT-VLS ATTRS-USED ECODE)))))))))
                        (VARIABLE
                          (LET ((ATTRS-USED (RT-SYMBOL NIL)))
                            (RT-MVB (TOKEN)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        EXP
                                                        ID
                                                        0
                                                        %TERM%
                                                        ATTRDEFS
                                                        TAGS
                                                        OPTCON
                                                        ERRCON)
                                    (LET ((ECODE TOKEN))
                                      (RT-VLS ATTRS-USED ECODE)))))
                        (SYMBOL
                          (LET ((ATTRS-USED (RT-SYMBOL NIL)))
                            (RT-MVB (TOKEN)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        EXP
                                                        ID
                                                        0
                                                        %TERM%
                                                        ATTRDEFS
                                                        TAGS
                                                        OPTCON
                                                        ERRCON)
                                    (LET ((ECODE
                                            (RT-FUNCTION SYMBOL-FUN
                                                         TOKEN)))
                                      (RT-VLS ATTRS-USED ECODE)))))
                        (NUMBER
                          (LET ((ATTRS-USED (RT-SYMBOL NIL)))
                            (RT-MVB (VALUE)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        EXP
                                                        NUMBER
                                                        0
                                                        %TERM%
                                                        ATTRDEFS
                                                        TAGS
                                                        OPTCON
                                                        ERRCON)
                                    (LET ((ECODE VALUE))
                                      (RT-VLS ATTRS-USED ECODE)))))
                        (STRING
                          (LET ((ATTRS-USED (RT-SYMBOL NIL)))
                            (RT-MVB (VALUE)
                                    (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                        EXP
                                                        STRING
                                                        0
                                                        %TERM%
                                                        ATTRDEFS
                                                        TAGS
                                                        OPTCON
                                                        ERRCON)
                                    (LET ((ECODE VALUE))
                                      (RT-VLS ATTRS-USED ECODE)))))
                        (ITE
                          (RT-MVB (AU-THEN E-THEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      1
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (RT-MVB (AU-PRED E-PRED)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              EXP
                                                              EXP
                                                              0
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              OPTCON
                                                              ERRCON)
                                          (RT-MVB (AU-ELSE E-ELSE)
                                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                      EXP
                                                                      EXP
                                                                      2
                                                                      %TERM%
                                                                      ATTRDEFS
                                                                      TAGS
                                                                      OPTCON
                                                                      ERRCON)
                                                  (LET ((ATTRS-USED
                                                          (RT-FUNCTION UNION
                                                                      (RT-FUNCTION
                                                                      UNION
                                                                      AU-PRED
                                                                      AU-THEN)
                                                                      AU-ELSE)))
                                                    (LET ((ECODE
                                                            (RT-FUNCTION
                                                              ITE-FUN
                                                              E-PRED
                                                              E-THEN
                                                              E-ELSE)))
                                                      (RT-VLS ATTRS-USED ECODE)))))))
                        (OPTSORT
                          (RT-MVB (T13 TOKEN)
                                  (RT-GET-SYNFAM-ARGN-OPT AF-SYNFAM
                                                          EXP
                                                          TAG
                                                          2
                                                          %TERM%
                                                          ATTRDEFS
                                                          TAGS
                                                          OPTCON
                                                          ERRCON)
                                  (LET ((TAGNAME (RT-OPT T13 TOKEN DTAG)))
                                    (LET ((TAGVALUE
                                            (RT-FUNCTION LOOKUPTAG
                                                         TAGS
                                                         TAGNAME)))
                                      (PROGN
                                        (RT-CONSTRAINT-CHECK TAGVALUE
                                                             (RT-FUNCTION
                                                               EMESSAGE
                                                               ERRCON
                                                               "Undefined tag ~A"
                                                               TAGNAME))
                                        (RT-MVB (AU-NULL E-NULL)
                                                (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                    EXP
                                                                    EXP
                                                                    0
                                                                    %TERM%
                                                                    ATTRDEFS
                                                                    TAGS
                                                                    OPTCON
                                                                    ERRCON)
                                                (RT-MVB (AU E-P)
                                                        (RT-GET-SYNFAM-ARGN
                                                          AF-SYNFAM
                                                          EXP
                                                          EXP
                                                          1
                                                          %TERM%
                                                          ATTRDEFS
                                                          TAGS
                                                          OPTCON
                                                          ERRCON)
                                                        (LET ((ATTRS-USED
                                                                (RT-FUNCTION
                                                                  UNION
                                                                  AU-NULL
                                                                  AU)))
                                                          (LET ((ECODE
                                                                  (RT-FUNCTION
                                                                    OPT-FUN
                                                                    TAGVALUE
                                                                    E-NULL
                                                                    E-P)))
                                                            (RT-VLS ATTRS-USED
                                                                    ECODE))))))))))
                        (FUNCT
                          (RT-MVB (ATTRS-USED E-ARG)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXPLIST
                                                      1
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (RT-MVB (TOKEN)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              EXP
                                                              ID
                                                              0
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              OPTCON
                                                              ERRCON)
                                          (LET ((ECODE
                                                  (RT-FUNCTION FUNCT-FUN
                                                               TOKEN
                                                               E-ARG)))
                                            (RT-VLS ATTRS-USED ECODE)))))
                        (ABSY
                          (LET ((ATTRS-USED (RT-SYMBOL NIL)))
                            (LET ((ECODE (RT-FUNCTION AST-FUN)))
                              (RT-VLS ATTRS-USED ECODE))))
                        (MULT
                          (RT-MVB (AU1 E1)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (RT-MVB (AU2 E2)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              EXP
                                                              EXP
                                                              1
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              OPTCON
                                                              ERRCON)
                                          (LET ((ATTRS-USED
                                                  (RT-FUNCTION UNION AU1 AU2)))
                                            (LET ((ECODE
                                                    (RT-FUNCTION MULT-FUN
                                                                 E1
                                                                 E2)))
                                              (RT-VLS ATTRS-USED ECODE))))))
                        (DIV
                          (RT-MVB (AU1 E1)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (RT-MVB (AU2 E2)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              EXP
                                                              EXP
                                                              1
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              OPTCON
                                                              ERRCON)
                                          (LET ((ATTRS-USED
                                                  (RT-FUNCTION UNION AU1 AU2)))
                                            (LET ((ECODE
                                                    (RT-FUNCTION DIV-FUN
                                                                 E1
                                                                 E2)))
                                              (RT-VLS ATTRS-USED ECODE))))))
                        (ADD
                          (RT-MVB (AU1 E1)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (RT-MVB (AU2 E2)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              EXP
                                                              EXP
                                                              1
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              OPTCON
                                                              ERRCON)
                                          (LET ((ATTRS-USED
                                                  (RT-FUNCTION UNION AU1 AU2)))
                                            (LET ((ECODE
                                                    (RT-FUNCTION PLUS-FUN
                                                                 E1
                                                                 E2)))
                                              (RT-VLS ATTRS-USED ECODE))))))
                        (MINUS
                          (RT-MVB (AU1 E1)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (RT-MVB (AU2 E2)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              EXP
                                                              EXP
                                                              1
                                                              %TERM%
                                                              ATTRDEFS
                                                              TAGS
                                                              OPTCON
                                                              ERRCON)
                                          (LET ((ATTRS-USED
                                                  (RT-FUNCTION UNION AU1 AU2)))
                                            (LET ((ECODE
                                                    (RT-FUNCTION MINUS-FUN
                                                                 E1
                                                                 E2)))
                                              (RT-VLS ATTRS-USED ECODE))))))
                        (NEG
                          (RT-MVB (ATTRS-USED E)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      EXP
                                                      EXP
                                                      0
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (LET ((ECODE (RT-FUNCTION NEG-FUN E)))
                                    (RT-VLS ATTRS-USED ECODE))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      EXPLIST
                      (%TERM%)
                      (ATTRDEFS TAGS OPTCON ERRCON)
                      (ERGO-IGNORE-IF-UNUSED ATTRDEFS TAGS OPTCON ERRCON)
                      (OPCASE
                        %TERM%
                        (ELIST
                          (RT-MVB (AU-ARG ECODE)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      EXPLIST
                                                      EXP
                                                      %TERM%
                                                      ATTRDEFS
                                                      TAGS
                                                      OPTCON
                                                      ERRCON)
                                  (LET ((AU (RT-FUNCTION UNIONLIST
                                                         AU-ARG)))
                                    (RT-VLS AU ECODE))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      ITERS
                      (%TERM%)
                      (ATTRDEFS ERRCON)
                      (ERGO-IGNORE-IF-UNUSED ATTRDEFS ERRCON)
                      (OPCASE
                        %TERM%
                        (ITERLIST
                          (RT-MVB (ITER-ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      ITERS
                                                      ITER
                                                      %TERM%
                                                      ATTRDEFS
                                                      ERRCON)
                                  (RT-VLS ITER-ATTR)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      ITER
                      (%TERM%)
                      (ATTRDEFS ERRCON)
                      (ERGO-IGNORE-IF-UNUSED ATTRDEFS ERRCON)
                      (OPCASE
                        %TERM%
                        (DECL-ITERATE
                          (RT-MVB (AU EC)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      ITER
                                                      EXP
                                                      1
                                                      %TERM%
                                                      ATTRDEFS
                                                      ERRCON)
                                  (RT-MVB (ATTR)
                                          (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                              ITER
                                                              ID
                                                              0
                                                              %TERM%
                                                              ATTRDEFS
                                                              ERRCON)
                                          (RT-MVB (FUN)
                                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                                      ITER
                                                                      ID
                                                                      2
                                                                      %TERM%
                                                                      ATTRDEFS
                                                                      ERRCON)
                                                  (LET ((ITER-ATTR
                                                          (RT-FUNCTION LIST
                                                                      ATTR
                                                                      (RT-FUNCTION
                                                                      MAKE-EXP
                                                                      EC
                                                                      AU)
                                                                      FUN)))
                                                    (RT-VLS ITER-ATTR))))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      DECLARATION
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (DECL-FINAL
                          (RT-MVB (ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      DECLARATION
                                                      ID
                                                      %TERM%)
                                  (RT-VLS ATTR)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      TAG
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (TID
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      TAG
                                                      ID
                                                      0
                                                      %TERM%)
                                  (RT-VLS TOKEN)))
                        (TNUM
                          (RT-MVB (TOKEN)
                                  (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                      TAG
                                                      NUMBER
                                                      0
                                                      %TERM%)
                                  (RT-VLS TOKEN)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      RULE-ATTRL
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (RULE-ATTRL
                          (RT-MVB (LHS-ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      RULE-ATTRL
                                                      LHS-ATTR
                                                      %TERM%)
                                  (RT-VLS LHS-ATTR)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      RULE-ALTL
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            EXTGRAM
                            TOKEN
                            LHS-ATTR
                            DECL
                            OATTRDEFS
                            ISIG
                            NERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             EXTGRAM
                                             TOKEN
                                             LHS-ATTR
                                             DECL
                                             OATTRDEFS
                                             ISIG
                                             NERRCON)
                      (OPCASE
                        %TERM%
                        (RULE-ALTL
                          (RT-MVB (_ _ _ _ _ _ NSIG)
                                  (IF (ZEROP (RT-NCHILD %TERM%))
                                      (RT-MVB
                                        (_ LANG
                                           CONFAM
                                           SYNFAM
                                           EXTGRAM
                                           TOKEN
                                           LHS-ATTR
                                           DECL
                                           OATTRDEFS
                                           ISIG
                                           NERRCON)
                                        (RT-DELTA-CONFAM AF-CONFAM
                                                         RULE-ALTL
                                                         -1
                                                         %TERM%
                                                         LANG
                                                         CONFAM
                                                         SYNFAM
                                                         EXTGRAM
                                                         TOKEN
                                                         LHS-ATTR
                                                         DECL
                                                         OATTRDEFS
                                                         ISIG
                                                         NERRCON)
                                        (RT-VLS _ _ _ _ _ _ ISIG))
                                      (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                          RULE-ALTL
                                                          ALTERNATIVE
                                                          (RT-LAST-CHILD %TERM%)
                                                          %TERM%
                                                          LANG
                                                          CONFAM
                                                          SYNFAM
                                                          EXTGRAM
                                                          TOKEN
                                                          LHS-ATTR
                                                          DECL
                                                          OATTRDEFS
                                                          ISIG
                                                          NERRCON))
                                  (RT-MVB
                                    (ALTCON ALTSYN
                                            ALTATT
                                            RCONEMBED0
                                            RSYNEMBED0
                                            NATTRDEFS
                                            _)
                                    (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                        RULE-ALTL
                                                        ALTERNATIVE
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        TOKEN
                                                        LHS-ATTR
                                                        DECL
                                                        OATTRDEFS
                                                        ISIG
                                                        NERRCON)
                                    (RT-VLS ALTCON
                                            ALTSYN
                                            ALTATT
                                            RCONEMBED0
                                            RSYNEMBED0
                                            NATTRDEFS
                                            NSIG))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      ALT-CSORTL
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            EXTGRAM
                            ATTRDEFS
                            OTAGS
                            OPOS
                            OSIG
                            OPER
                            N-LHS
                            ITER-ATTRS
                            NERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             EXTGRAM
                                             ATTRDEFS
                                             OTAGS
                                             OPOS
                                             OSIG
                                             OPER
                                             N-LHS
                                             ITER-ATTRS
                                             NERRCON)
                      (OPCASE
                        %TERM%
                        (ALT-CSORTL
                          (RT-MVB (_ _
                                     IATTRDEFS
                                     NTAGS
                                     NPOS
                                     _
                                     _
                                     NSIG)
                                  (IF (ZEROP (RT-NCHILD %TERM%))
                                      (RT-MVB
                                        (_ LANG
                                           CONFAM
                                           SYNFAM
                                           EXTGRAM
                                           ATTRDEFS
                                           OTAGS
                                           OPOS
                                           OSIG
                                           OPER
                                           N-LHS
                                           ITER-ATTRS
                                           NERRCON)
                                        (RT-DELTA-CONFAM AF-CONFAM
                                                         ALT-CSORTL
                                                         -1
                                                         %TERM%
                                                         LANG
                                                         CONFAM
                                                         SYNFAM
                                                         EXTGRAM
                                                         ATTRDEFS
                                                         OTAGS
                                                         OPOS
                                                         OSIG
                                                         OPER
                                                         N-LHS
                                                         ITER-ATTRS
                                                         NERRCON)
                                        (RT-VLS _
                                                _
                                                ATTRDEFS
                                                OTAGS
                                                OPOS
                                                _
                                                _
                                                OSIG))
                                      (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                          ALT-CSORTL
                                                          CHILD-SORT
                                                          (RT-LAST-CHILD %TERM%)
                                                          %TERM%
                                                          LANG
                                                          CONFAM
                                                          SYNFAM
                                                          EXTGRAM
                                                          ATTRDEFS
                                                          OTAGS
                                                          OPOS
                                                          OSIG
                                                          OPER
                                                          N-LHS
                                                          ITER-ATTRS
                                                          NERRCON))
                                  (RT-MVB
                                    (RCONEMBED0 RSYNEMBED0
                                                _
                                                _
                                                _
                                                RHS-ATTR
                                                TLIST
                                                _)
                                    (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                        ALT-CSORTL
                                                        CHILD-SORT
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        ATTRDEFS
                                                        OTAGS
                                                        OPOS
                                                        OSIG
                                                        OPER
                                                        N-LHS
                                                        ITER-ATTRS
                                                        NERRCON)
                                    (RT-VLS RCONEMBED0
                                            RSYNEMBED0
                                            IATTRDEFS
                                            NTAGS
                                            NPOS
                                            RHS-ATTR
                                            TLIST
                                            NSIG))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      CONST-ATTRL
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (CONST-ATTRL
                          (RT-MVB (RHS-ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      CONST-ATTRL
                                                      RHS-ATTR
                                                      %TERM%)
                                  (RT-VLS RHS-ATTR)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      TLIST-ATTRL
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (TLIST-ATTRL
                          (RT-MVB (ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      TLIST-ATTRL
                                                      RHS-ATTR
                                                      %TERM%)
                                  (RT-VLS ATTR)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      EMB-CSORTL
                      (%TERM%)
                      (LANG CONFAM
                            SYNFAM
                            EXTGRAM
                            OEATTRDEFS
                            OTAGS
                            OPOS
                            OSIG
                            TOKEN
                            N-LHS
                            ITER-ATTRS
                            ERRCON)
                      (ERGO-IGNORE-IF-UNUSED LANG
                                             CONFAM
                                             SYNFAM
                                             EXTGRAM
                                             OEATTRDEFS
                                             OTAGS
                                             OPOS
                                             OSIG
                                             TOKEN
                                             N-LHS
                                             ITER-ATTRS
                                             ERRCON)
                      (OPCASE
                        %TERM%
                        (EMB-CSORTL
                          (RT-MVB (_ _
                                     IEATTRDEFS
                                     NTAGS
                                     NPOS
                                     _
                                     _
                                     ISIG)
                                  (IF (ZEROP (RT-NCHILD %TERM%))
                                      (RT-MVB
                                        (_ LANG
                                           CONFAM
                                           SYNFAM
                                           EXTGRAM
                                           OEATTRDEFS
                                           OTAGS
                                           OPOS
                                           OSIG
                                           TOKEN
                                           N-LHS
                                           ITER-ATTRS
                                           ERRCON)
                                        (RT-DELTA-CONFAM AF-CONFAM
                                                         EMB-CSORTL
                                                         -1
                                                         %TERM%
                                                         LANG
                                                         CONFAM
                                                         SYNFAM
                                                         EXTGRAM
                                                         OEATTRDEFS
                                                         OTAGS
                                                         OPOS
                                                         OSIG
                                                         TOKEN
                                                         N-LHS
                                                         ITER-ATTRS
                                                         ERRCON)
                                        (RT-VLS _
                                                _
                                                OEATTRDEFS
                                                OTAGS
                                                OPOS
                                                _
                                                _
                                                OSIG))
                                      (RT-GET-SYNFAM-ARGN AF-SYNFAM
                                                          EMB-CSORTL
                                                          CHILD-SORT
                                                          (RT-LAST-CHILD %TERM%)
                                                          %TERM%
                                                          LANG
                                                          CONFAM
                                                          SYNFAM
                                                          EXTGRAM
                                                          OEATTRDEFS
                                                          OTAGS
                                                          OPOS
                                                          OSIG
                                                          TOKEN
                                                          N-LHS
                                                          ITER-ATTRS
                                                          ERRCON))
                                  (RT-MVB
                                    (ERCONEMBED ERSYNEMBED
                                                _
                                                _
                                                _
                                                ERHS-ATTR
                                                ETLIST
                                                _)
                                    (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                        EMB-CSORTL
                                                        CHILD-SORT
                                                        %TERM%
                                                        LANG
                                                        CONFAM
                                                        SYNFAM
                                                        EXTGRAM
                                                        OEATTRDEFS
                                                        OTAGS
                                                        OPOS
                                                        OSIG
                                                        TOKEN
                                                        N-LHS
                                                        ITER-ATTRS
                                                        ERRCON)
                                    (RT-VLS ERCONEMBED
                                            ERSYNEMBED
                                            IEATTRDEFS
                                            NTAGS
                                            NPOS
                                            ERHS-ATTR
                                            ETLIST
                                            ISIG))))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      ECONST-ATTRL
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (ECONST-ATTRL
                          (RT-MVB (RHS-ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      ECONST-ATTRL
                                                      RHS-ATTR
                                                      %TERM%)
                                  (RT-VLS RHS-ATTR)))))
(RT-DEFSYNFAM-COMPFUN AF-SYNFAM
                      ETLIST-ATTRL
                      (%TERM%)
                      NIL
                      (ERGO-IGNORE-IF-UNUSED)
                      (OPCASE
                        %TERM%
                        (ETLIST-ATTRL
                          (RT-MVB (ATTR)
                                  (RT-GET-SYNFAM-LIST AF-SYNFAM
                                                      ETLIST-ATTRL
                                                      RHS-ATTR
                                                      %TERM%)
                                  (RT-VLS ATTR)))))

(RT-DEFATTRFAM-ATTRFUN AF-ATTRFAM
                       AGG
                       (%TERM%)
                       NIL
                       (RDEC RCON RSYN RATT)
                       (ERGO-IGNORE-IF-UNUSED)
                       (OPCASE
                         %TERM% (AGG (RT-VLS RDEC RCON RSYN RATT))))
